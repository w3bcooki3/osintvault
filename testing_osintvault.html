
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Primary Meta Tags -->
    <title>OSINTVault - Your Personal OSINT Workspace</title>
    <meta name="title" content="OSINTVault - Your Personal OSINT Workspace">
    <meta name="description" content="OSINTVault is a free, browser-based OSINT workspace to manage tools, investigations, dorks, IOCs, and notes — no backend, fully private.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://w3bcooki3.github.io/osintvault/">
    <meta property="og:title" content="OSINTVault - Your Personal OSINT Workspace">
    <meta property="og:description" content="A free, privacy-respecting tool for managing OSINT tools, investigations, dork queries, and more — all in your browser.">
    <meta property="og:image" content="https://w3bcooki3.github.io/osintvault/assets/preview-image.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://w3bcooki3.github.io/osintvault/">
    <meta property="twitter:title" content="OSINTVault - Your Personal OSINT Workspace">
    <meta property="twitter:description" content="A free, privacy-respecting tool for managing OSINT tools, investigations, dork queries, and more — all in your browser.">
    <meta property="twitter:image" content="https://w3bcooki3.github.io/osintvault/assets/preview-image.png">

    <!-- SEO -->
    <meta name="keywords" content="OSINT, OSINT tools, cybersecurity, threat intelligence, investigation, dork builder, open source, local storage, incident response, malware analysis">
    <meta name="author" content="w3bcooki3">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="./favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="./css/style.css">

</head>
    <body>
        <header>
            <div class="header-content">
                <div class="logo-and-title-container">
                    <div class="header-logo">
                        <img src="./favicon.png" alt="OSINTVault Logo" class="osintvault-logo-img">
                    </div>
                    <div class="header-text-group">
                        <div class="header-title">
                            OSINTVault
                        </div>
                        <span class="header-tagline">Carry your investigations everywhere</span>
                    </div>
                </div>
        
                <div class="mobile-menu-toggle">☰</div>
                <div class="controls">
                    <div class="search-container">
                        <input type="text" class="search-input" id="searchInput" placeholder="Search intelligence tools, techniques, indicators...">
                        <i class="fas fa-search search-icon"></i>
                        <select id="searchScopeSelect">
                            <option value="currentTab">Current Tab</option>
                            <option value="allVault">All Intelligence Vault</option>
                            <option value="allData">All Data</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary" id="exportBtn">
                        <i class="fas fa-download"></i>
                        Export
                    </button>
                    <button class="btn btn-secondary" id="shareOptionsBtn">
                        <i class="fas fa-share-alt"></i>
                        Share
                    </button>
                    <button class="btn btn-secondary" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>

            <div class="header-controls-expanded">
                <div class="header-filters-compact">
                    <label for="categoryFilter">Filters:</label>
                    <div class="form-group-inline">
                        <label for="categoryFilter">Category:</label>
                        <select id="categoryFilter">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                    <div class="form-group-inline">
                        <label for="sortFilter">Sort By:</label>
                        <select id="sortFilter">
                            <option value="name">Name (A-Z)</option>
                            <option value="recent">Recently Added</option>
                            <option value="popular">Most Used</option>
                        </select>
                    </div>
                </div>

                <div class="header-quick-actions-compact">
                    <span>Quick Actions:</span>
                    <button class="btn btn-secondary btn-compact" id="showAllBtn" title="Show All Entries">
                        <i class="fas fa-eye"></i> Show All
                    </button>
                    <button class="btn btn-secondary btn-compact" id="pinAllBtn" title="Show Pinned Entries">
                        <i class="fas fa-thumbtack"></i> Pinned
                    </button>
                    <button class="btn btn-secondary btn-compact" id="starAllBtn" title="Show Starred Entries">
                        <i class="fas fa-star"></i> Starred
                    </button>
                    <button class="btn btn-success btn-compact" id="reportBtn" title="Generate Report">
                        <i class="fas fa-file-alt"></i> Report
                    </button>
                </div>
            </div>
        </header>

        <div id="mobileSidebarMenu" class="mobile-sidebar-menu">
            <button class="close-menu-btn">&times;</button>
            <div class="mobile-menu-content"></div>
        </div>

        <div class="dashboard">
            <div class="main-content">
                <div class="nav-tabs main-nav-tabs">
                    <button class="nav-tab active" data-tab="dashboard">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </button>
                    <button class="nav-tab" data-tab="intelligence-vault">
                        <i class="fas fa-tools"></i>
                        Intelligence Vault
                    </button>
                    <button class="nav-tab" data-tab="custom-tabs">
                        <i class="fas fa-layer-group"></i>
                        Multi-Vault
                    </button>
                    <button class="nav-tab" data-tab="dork-assistant">
                        <i class="fas fa-terminal"></i> 
                        Dork Assistant
                    </button>
                    <button class="nav-tab" data-tab="case-studies">
                        <i class="fas fa-microscope"></i>
                        Case Studies
                    </button>
                    <button class="nav-tab" data-tab="handbook">
                        <i class="fas fa-book"></i> 
                        OSINT Handbook & Notes
                    </button>
                    <button class="nav-tab" data-tab="threat-hunting">
                        <i class="fas fa-crosshairs"></i>
                        Threat Hunting
                    </button>
                    <button class="nav-tab" data-tab="timeline">
                        <i class="fas fa-stream"></i> 
                        TraceLink
                    </button>
                    <button class="nav-tab" data-tab="threats">
                        <i class="fas fa-exclamation-triangle"></i>
                        Threat Intel
                    </button>
                </div>

                <div class="bulk-actions" id="bulkActions">
                    <span>Selected: <span id="selectedCount">0</span> tools</span>
                    <button class="btn btn-secondary" id="bulkStarBtn">
                        <i class="fas fa-star"></i>
                        Star/Unstar Selected
                    </button>
                    <button class="btn btn-secondary" id="bulkPinBtn">
                        <i class="fas fa-thumbtack"></i>
                        Pin/Unpin Selected
                    </button>
                    <button class="btn btn-danger" id="bulkDeleteBtn">
                        <i class="fas fa-trash"></i>
                        Delete Selected
                    </button>
                </div>

                <div class="tab-content" id="toolsTab">
                    <div class="content-header">
                        <h2 class="content-title">Intelligence Tools Arsenal</h2>
                        <div class="controls">
                            <button class="btn btn-secondary" id="viewToggle" title="Switch to List View">
                                <i class="fas fa-list"></i>
                                List View
                            </button>
                        </div>
                    </div>
                    
                    <div class="tools-grid" id="toolsGrid">
                        </div>

                    <div class="empty-state" id="emptyState" style="display: none;">
                        <i class="fas fa-search"></i>
                        <h3>No Tools Found</h3>
                        <p>No intelligence tools match your current search criteria.</p>
                        <button class="btn btn-primary" id="clearFiltersBtn">
                            <i class="fas fa-times"></i>
                            Clear Filters
                        </button>
                    </div>
                </div>

                <div class="tab-content active" id="dashboardTab">
                    <div class="content-header">
                        <h2 class="content-title">Dashboard Overview</h2>
                    </div>
                
                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <div class="analytics-value" id="totalToolsCount">0</div>
                            <div>Total Entries</div>
                        </div>
                        <div class="analytics-card">
                            <div class="analytics-value" id="activeVaultsCount">0</div>
                            <div>Active Custom Vaults</div>
                        </div>
                        <div class="analytics-card">
                            <div class="analytics-value" id="usedToolsTodayCount">0</div>
                            <div>Entries Used Today</div>
                        </div>
                        <div class="analytics-card">
                            <div class="analytics-value" id="notesCount">0</div>
                            <div>Total Notes</div>
                        </div>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 30px;">
                        <h4 style="margin-bottom: 20px;">Overall OSINT Metrics</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                            <div class="analytics-card" style="flex: 1; min-width: 300px; height: 300px;">
                                <canvas id="entriesByTypeChart"></canvas>
                            </div>
                            <div class="analytics-card" style="flex: 1; min-width: 300px; height: 300px;">
                                <canvas id="usageTrendChart"></canvas>
                            </div>
                        </div>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 30px;">
                        <h4 style="margin-bottom: 20px;">Vault Content Distribution</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                            <div class="analytics-card" style="flex: 1; min-width: 300px; height: 300px;">
                                <canvas id="topCategoriesChart"></canvas>
                            </div>
                            <div class="analytics-card" style="flex: 1; min-width: 300px; height: 300px;">
                                <canvas id="pinnedStarredDonutChart"></canvas>
                            </div>
                        </div>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 30px;">
                        <h4 style="margin-bottom: 20px;">Vault Growth & Health</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                            <div class="analytics-card" style="flex: 1; min-width: 300px; height: 300px;">
                                <canvas id="entryGrowthOverTimeChart"></canvas>
                            </div>
                            <div class="analytics-card" style="flex: 1; min-width: 300px; height: 300px;">
                                <canvas id="taggingOverviewChart"></canvas>
                            </div>
                        </div>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 20px;">
                        <h4>Starred & Pinned Breakdown by Type</h4>
                        <ul class="analytics-list" id="starredPinnedBreakdownList">
                            </ul>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 20px;">
                        <h4>Intelligence Vault Summary (Tools)</h4>
                        <ul class="analytics-list" id="intelligenceVaultSummaryList">
                            <li><span>Total Tools:</span> <span class="stat-value" id="intelVaultTotalTools">0</span></li>
                            <li><span>Starred Tools:</span> <span class="stat-value" id="intelVaultStarredTools">0</span></li>
                            <li><span>Pinned Tools:</span> <span class="stat-value" id="intelVaultPinnedTools">0</span></li>
                            <li><span>Tool Categories:</span> <span class="stat-value" id="intelVaultCategoriesCount">0</span></li>
                        </ul>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 20px;">
                        <h4>Custom Vaults Summary</h4>
                        <ul class="analytics-list" id="customVaultsSummaryList">
                            <li><span>Total Custom Vaults:</span> <span class="stat-value" id="customVaultsTotal">0</span></li>
                            <li><span>Total Entries in Custom Vaults:</span> <span class="stat-value" id="customVaultsTotalEntries">0</span></li>
                            <li><span>Avg. Entries per Custom Vault:</span> <span class="stat-value" id="customVaultsAvgEntries">0</span></li>
                            <div class="analytics-card" style="flex: 1; min-width: 300px; height: 300px; margin-top: 20px;">
                                <canvas id="entriesPerCustomVaultChart"></canvas>
                            </div>
                        </ul>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 20px;">
                        <h4>Notes & Dork Assistant Summary</h4>
                        <ul class="analytics-list" id="notesDorkSummaryList">
                            <li><span>Total Notes:</span> <span class="stat-value" id="notesSummaryTotal">0</span></li>
                            <li><span>Pinned Notes:</span> <span class="stat-value" id="notesSummaryPinned">0</span></li>
                            <li><span>Total Saved Dork Queries:</span> <span class="stat-value" id="dorksSummaryTotal">0</span></li>
                            <li><span>Pre-Templates Available:</span> <span class="stat-value" id="dorksSummaryTemplates">0</span></li>
                        </ul>
                    </div>
                
                    <div class="analytics-section" style="margin-top: 20px;">
                        <h4>Top 5 Most Used Entries</h4>
                        <ul class="analytics-list" id="mostUsedToolsList">
                            </ul>
                        <div class="empty-state" id="noMostUsedTools" style="display:none; padding:20px;">
                            <p>No usage data available yet.</p>
                        </div>
                    </div>
                
                    <div class="analytics-section">
                        <h4>Entries Never Used</h4>
                        <ul class="analytics-list" id="neverUsedToolsList">
                            </ul>
                        <div class="empty-state" id="noNeverUsedTools" style="display:none; padding:20px;">
                            <p>All entries have been used at least once!</p>
                        </div>
                    </div>
                
                    <div class="analytics-section">
                        <h4>Entries Added Per Week</h4>
                        <ul class="analytics-list" id="toolsAddedPerWeekList">
                            </ul>
                        <div class="empty-state" id="noToolsAdded" style="display:none; padding:20px;">
                            <p>No entries added recently.</p>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="threatsTab">
                    <div class="content-header">
                        <h2 class="content-title">Threat Intelligence Feed</h2>
                        <button class="btn btn-primary" id="refreshThreatsBtn">
                            <i class="fas fa-sync"></i>
                            Refresh Feed
                        </button>
                    </div>
                    
                    <div id="threatsList">
                        </div>
                </div>

                <div class="tab-content active" id="intelligence-vaultTab">
                    <div class="content-header">
                        <h2 class="content-title">Intelligence Vault (OSINT Tools)</h2>
                        <div class="controls">
                            <button class="btn btn-primary" id="addToolBtnIntelligenceVault">
                                <i class="fas fa-plus-circle"></i>
                                Add New Tool
                            </button>
                            <button class="btn btn-secondary" id="vaultViewToggle" title="Switch to List View">
                                <i class="fas fa-list"></i>
                                List View
                            </button>
                        </div>
                    </div>
                
                    <div class="nav-tabs" id="intelligenceVaultParentTabs" style="margin-top: 20px;">
                        </div>
                
                    <div class="sub-nav-tabs" id="intelligenceVaultChildTabs" style="display: none; margin-top: 15px;">
                        </div>
                
                    <div class="tools-grid" id="intelligenceVaultEntries" style="margin-top: 20px;">
                        </div>

                    <div class="empty-state" id="emptyCustomTabState" style="display: none;">
                        </div>
                
                    <div class="empty-state" id="emptyIntelligenceVaultState" style="display: none;">
                        <i class="fas fa-database"></i>
                        <h3>No Tools Found in This Category</h3>
                        <p>No OSINT tools match your current criteria in this category.</p>
                        <button class="btn2 btn-primary" id="addToolBtnEmptyState">
                            Add New Tool
                        </button>
                    </div>
                </div>


                <div class="tab-content" id="custom-tabsTab">
                    <div class="content-header">
                        <h2 class="content-title">Multi-Vault: Your Investigations</h2>
                        <div class="controls">
                            <button class="btn btn-primary" id="createSubTabBtn">
                                <i class="fas fa-plus"></i>
                                Create Custom Vault
                            </button>
                            <button class="btn btn-secondary" id="editSubTabBtn" style="display: none;">
                                <i class="fas fa-edit"></i>
                                Edit Vault
                            </button>
                            <button class="btn btn-danger" id="deleteSubTabBtn" style="display: none;">
                                <i class="fas fa-trash"></i>
                                Delete Vault
                            </button>
                            <button class="btn btn-secondary" id="exportSubTabBtn" style="display: none;">
                                <i class="fas fa-download"></i>
                                Export Vault
                            </button>
                        </div>
                    </div>

                    <div class="sub-nav-tabs" id="customSubTabs">
                    </div>

                    <div id="customVaultButtonsRow" style="margin-top: 20px; text-align: right;">
                        <button class="btn btn-success" id="addEntryBtnCustomVault">
                            <i class="fas fa-plus-circle"></i>
                            Add New Entry
                        </button>
                        <button class="btn btn-secondary" id="customVaultTimelineBtn">
                            <i class="fas fa-stream"></i>
                            Vault Timeline
                        </button>
                        <button class="btn btn-secondary" id="customVaultViewToggle" title="Switched to List View">
                            <i class="fas fa-list"></i>
                            List View
                        </button>
                    </div>

                    <div class="nav-tabs" id="customVaultEntryParentTabs" style="margin-top: 20px; display: none;">
                        </div>
                
                    <div class="sub-nav-tabs" id="customVaultEntryChildTabs" style="margin-top: 15px; display: none;">
                        </div>

                    <div class="tools-grid" id="customTabToolsGrid" style="margin-top: 20px;">
                        </div>

                    <div id="customTabTimelineDisplay" style="display: none; margin-top: 20px;">
                        </div>

                    <div class="empty-state" id="emptyCustomVaultTimelineState" style="display: none;">
                        <i class="fas fa-clock"></i>
                        <h3>No Events in this Vault</h3>
                        <p>Add entries to this custom vault to see them on the timeline!</p>
                    </div>
                    <div class="empty-state" id="emptyCustomTabState" style="display: none;">
                        <i class="fas fa-folder-open"></i>
                        <h3>No Custom Vault Yet</h3>
                        <p>Create your first custom vault to organize your investigations!</p>
                        <button class="btn2 btn-primary" id="createSubTabBtnEmptyState">
                            Create Custom Vault
                        </button>
                    </div>
                    <div class="empty-state" id="emptyCurrentCustomTabState" style="display: none;">
                        <i class="fas fa-clipboard"></i>
                        <h3>No Entries in this Custom Vault</h3>
                        <p>Add tools or collected intelligence to this vault using the "Add New Entry" button.</p>
                    </div>
                </div>

                <div class="tab-content" id="handbookTab">

                    <div class="sub-nav-tabs">
                        <button class="sub-nav-tab handbook-subtab active" data-subtab="handbook">
                            <i class="fas fa-book"></i> OSINT Handbook
                        </button>
                        <button class="sub-nav-tab handbook-subtab" data-subtab="notes">
                            <i class="fas fa-sticky-note"></i> My Notes
                        </button>
                    </div>

                    <div class="handbook-subtab-content" id="handbook-content" style="display: block;">
                        <div class="handbook-container">
                            <div class="handbook-sidebar" id="handbook-sidebar">
                                <div class="handbook-search-container">
                                    <input type="text" id="handbook-search" class="handbook-search" placeholder="Search handbook...">
                                    <i class="fas fa-search handbook-search-icon"></i>
                                </div>
                                </div>
                            
                            <div class="handbook-content-container">
                                <div class="handbook-content" id="handbook-article-area"> </div>
                            </div>
                        </div>
                        
                        <button id="handbook-mobile-toggle" class="handbook-mobile-toggle">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                    
                    <div class="handbook-subtab-content" id="notes-content" style="display: none;">
                        <div class="notes-container">
                            <div id="notes-list-view" class="notes-list-view">
                                <div class="notes-header">
                                    <h2 class="notes-title">My Notes</h2>
                                    <div class="notes-search-container">
                                        <input type="text" id="search-notes" class="notes-search" placeholder="Search notes...">
                                        <i class="fas fa-search notes-search-icon"></i>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label for="noteSortFilter" class="sr-only">Sort Notes</label>
                                        <select id="noteSortFilter" style="padding: 10px 12px; border-radius: 8px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); box-shadow: inset 0 1px 3px rgba(0,0,0,0.08);">
                                            <option value="updated_desc">Last Updated (Newest)</option>
                                            <option value="updated_asc">Last Updated (Oldest)</option>
                                            <option value="created_desc">Created (Newest)</option>
                                            <option value="created_asc">Created (Oldest)</option>
                                            <option value="title_asc">Title (A-Z)</option>
                                            <option value="title_desc">Title (Z-A)</option>
                                        </select>
                                    </div>
                                    <button id="new-note-btn" class="new-note-btn">
                                        <i class="fas fa-plus"></i> New Note
                                    </button>
                                </div>
                                
                                <div id="notes-list"></div>
                            </div>
                            
                            <div id="note-editor-view" class="note-editor-view" style="display: none;">
                                <div class="note-editor-header">
                                    <h2 class="note-editor-title">Edit Note</h2>
                                    <div class="note-editor-actions">
                                        <button id="back-to-notes-btn" class="back-btn">
                                            <i class="fas fa-arrow-left"></i> Back to Notes
                                        </button>
                                        <button id="edit-note-btn" class="edit-note-btn" style="display: none;">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button id="cancel-edit-note-btn" class="btn btn-secondary" style="display: none;">
                                            <i class="fas fa-times"></i> Cancel
                                        </button>
                                        <button id="save-note-btn" class="save-note-btn">
                                            <i class="fas fa-save"></i> Save
                                        </button>
                                    </div>
                                </div>
                                
                                <input type="text" id="note-title-input" class="note-title-input" placeholder="Note Title" maxlength="70">
                                
                                <div id="formatting-toolbar" class="formatting-toolbar">
                                    <button class="formatting-btn" data-command="bold" title="Bold">
                                        <i class="fas fa-bold"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="italic" title="Italic">
                                        <i class="fas fa-italic"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="underline" title="Underline">
                                        <i class="fas fa-underline"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="strikeThrough" title="Strikethrough">
                                        <i class="fas fa-strikethrough"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="formatBlock" data-value="h1" title="Heading 1">
                                        <i class="fas fa-heading"></i>1
                                    </button>
                                    <button class="formatting-btn" data-command="formatBlock" data-value="h2" title="Heading 2">
                                        <i class="fas fa-heading"></i>2
                                    </button>
                                    <button class="formatting-btn" data-command="formatBlock" data-value="h3" title="Heading 3">
                                        <i class="fas fa-heading"></i>3
                                    </button>
                                    <button class="formatting-btn" data-command="insertUnorderedList" title="Bullet List">
                                        <i class="fas fa-list-ul"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="insertOrderedList" title="Numbered List">
                                        <i class="fas fa-list-ol"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="createLink" title="Insert Link">
                                        <i class="fas fa-link"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="justifyLeft" title="Align Left">
                                        <i class="fas fa-align-left"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="justifyCenter" title="Align Center">
                                        <i class="fas fa-align-center"></i>
                                    </button>
                                    <button class="formatting-btn" data-command="justifyRight" title="Align Right">
                                        <i class="fas fa-align-right"></i>
                                    </button>
                                </div>
                                
                                <div id="note-content-editor" class="note-content-editor" contenteditable="true"></div>
                                
                                <div class="note-tags-section">
                                    <h3 class="note-tags-header">Tags</h3>
                                    <div id="note-tags-container" class="note-tags-container">
                                        </div>
                                    <div id="tag-input-container" class="tag-input-container">
                                        <input type="text" id="note-tags-input" class="note-tags-input" placeholder="Add a tag...">
                                        <button id="add-tag-btn" class="add-tag-btn">
                                            <i class="fas fa-plus"></i> Add
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="dork-assistantTab">
                    <div class="sub-nav-tabs">
                        <button class="sub-nav-tab dork-subtab active" data-dork-subtab="query-playground">
                            <i class="fas fa-hammer"></i> Query Playground
                        </button>
                        <button class="sub-nav-tab dork-subtab" data-dork-subtab="pre-templates">
                            <i class="fas fa-list-alt"></i> Pre-Templates
                        </button>
                        <button class="sub-nav-tab dork-subtab" data-dork-subtab="saved-queries">
                            <i class="fas fa-save"></i> Saved Queries
                        </button>
                    </div>

                    <div class="dork-subtab-content" id="query-playground-content" style="display: block; margin-top: 20px;">
                        <div class="content-header">
                            <h2 class="content-title">Query Playground</h2>
                            <div class="controls">
                                <button class="btn btn-secondary" id="clearDorkBuilderBtn">
                                    <i class="fas fa-eraser"></i> Clear Builder
                                </button>
                                <button class="btn btn-primary" id="executeDorkBtn">
                                    <i class="fas fa-play"></i> Execute Query
                                </button>
                            </div>
                        </div>

                        <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                            <div style="flex: 1; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px; padding: 20px; box-shadow: var(--shadow);">
                                <h4 style="color: var(--text-primary); margin-bottom: 15px;"><i class="fas fa-cogs"></i> Builder Options</h4>
                                <div class="form-group">
                                    <label for="dorkEngineSelect">Target Search Engine</label>
                                    <select id="dorkEngineSelect" class="form-group-input">
                                        <option value="google">Google</option>
                                        <option value="duckduckgo">DuckDuckGo</option>
                                        <option value="bing">Bing</option>
                                        <option value="yandex">Yandex</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>Keywords / Phrases (separated by comma)</label>
                                    <input type="text" id="dorkKeywords" placeholder="e.g., 'john doe', 'confidential report'">
                                </div>

                                <div style="margin-top: 20px;">
                                    <h5 style="color: var(--text-primary); margin-bottom: 10px;">Operators</h5>
                                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="site:" title="Search within a specific website.">site:</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="filetype:" title="Search for specific file types (e.g., pdf, docx, xls).">filetype:</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="intitle:" title="Search for terms in the page title.">intitle:</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="inurl:" title="Search for terms in the URL.">inurl:</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="intext:" title="Search for terms within the page text.">intext:</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="related:" title="Find sites related to a given URL.">related:</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="cache:" title="Show the cached version of a page.">cache:</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="AROUND()" title="Find terms within a certain proximity (e.g., term1 AROUND(5) term2).">AROUND()</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="OR" title="Boolean OR operator.">OR</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="AND" title="Boolean AND operator.">AND</button>
                                        <button class="btn btn-secondary btn-sm dork-operator-btn" data-operator="-" title="Exclude a term.">-</button>
                                    </div>
                                </div>

                                <div class="form-group" style="margin-top: 20px;">
                                    <label>Additional Custom Operators / Terms</label>
                                    <textarea id="dorkCustomInput" rows="4" placeholder="Add custom operators or full dork segments here. Example: inurl:/admin/ &quot;login&quot;"></textarea>
                                </div>
                                <button class="btn btn-success" id="saveCurrentDorkBtn" style="width: 100%; margin-top: 20px;">
                                    <i class="fas fa-save"></i> Save Current Query
                                </button>
                            </div>

                            <div style="flex: 1; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 12px; padding: 20px; box-shadow: var(--shadow);">
                                <h4 style="color: var(--text-primary); margin-bottom: 15px;"><i class="fas fa-eye"></i> Live Query Preview</h4>
                                <textarea id="dorkQueryPreview" rows="12" readonly style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 8px; padding: 15px; width: 100%; font-family: 'JetBrains Mono', monospace; font-size: 14px; resize: vertical;"></textarea>

                                <div style="margin-top: 20px;">
                                    <h4 style="color: var(--text-primary); margin-bottom: 15px;"><i class="fas fa-exchange-alt"></i> Convert Query</h4>
                                    <div class="form-group">
                                        <label for="conversionTarget">Convert to (Shodan/Censys)</label>
                                        <select id="conversionTarget" class="form-group-input">
                                            <option value="">Select Target</option>
                                            <option value="shodan">Shodan</option>
                                            <option value="censys">Censys</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-secondary" id="convertDorkBtn" style="width: 100%; margin-bottom: 10px;">Convert & Preview</button>
                                    <textarea id="convertedDorkPreview" rows="4" readonly style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 8px; padding: 15px; width: 100%; font-family: 'JetBrains Mono', monospace; font-size: 14px; resize: vertical; display: none;"></textarea>
                                    <button class="btn btn-primary" id="executeConvertedDorkBtn" style="width: 100%; margin-top: 10px; display: none;">
                                        <i class="fas fa-play"></i> Execute Converted Query
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dork-subtab-content" id="pre-templates-content" style="display: none; margin-top: 20px;">
                        <div class="pre-templates-container">
                            <div class="pre-templates-sidebar">
                                <h3 style="color: var(--primary); margin-bottom: 15px;"><i class="fas fa-folder-open"></i> Categories</h3>
                                <div id="preTemplateCategoriesList">
                                    </div>
                                <div class="empty-state" id="preTemplateCategoriesEmptyState" style="display: none; padding: 15px; margin-top: 15px;">
                                    <i class="fas fa-info-circle" style="font-size: 24px;"></i>
                                    <p style="font-size: 0.9em;">No categories available.</p>
                                </div>
                            </div>

                            <div class="pre-templates-main">
                                <div class="content-header">
                                    <h2 class="content-title" id="currentTemplateCategoryTitle">All Templates</h2>
                                    <div class="controls">
                                        <input type="text" id="preTemplateSearchInput" class="search-input" placeholder="Search templates..." style="max-width: 300px; margin-right: 10px;">
                                        <button class="btn btn-secondary" id="clearPreTemplateSearch">
                                            <i class="fas fa-times"></i> Clear Search
                                        </button>
                                    </div>
                                </div>
                                <div id="dorkTemplatesList" class="tools-grid">
                                    </div>
                                <div class="empty-state" id="preTemplatesEmptyState" style="display: none;">
                                    <i class="fas fa-clipboard-list"></i>
                                    <h3>No Templates Found</h3>
                                    <p>Adjust your search or select another category.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dork-subtab-content" id="saved-queries-content" style="display: none; margin-top: 20px;">
                        <div class="content-header">
                            <h2 class="content-title">My Saved Dork Queries</h2>
                            <div class="controls">
                                <input type="text" id="savedQueriesSearch" class="search-input" placeholder="Search saved queries..." style="max-width: 300px; margin-right: 10px;">
                                <button class="btn btn-secondary" id="clearSavedQueriesSearch">
                                    <i class="fas fa-times"></i> Clear Search
                                </button>
                            </div>
                        </div>
                        <div id="savedQueriesList" class="tools-grid">
                            </div>
                        <div class="empty-state" id="savedQueriesEmptyState" style="display: block;">
                            <i class="fas fa-bookmark"></i>
                            <h3>No Saved Queries Yet</h3>
                            <p>Save your favorite dork queries from the Query Playground!</p>
                        </div>
                    </div>

                    <div class="modal" id="saveDorkQueryModal">
                        <div class="modal-content">
                            <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-save"></i> Save Dork Query</h3>
                            <form id="saveDorkQueryForm">
                                <div class="form-group">
                                    <label for="savedQueryName">Query Name</label>
                                    <input type="text" id="savedQueryName" required placeholder="e.g., Exposed PDF Reports for Acme Corp">
                                </div>
                                <div class="form-group">
                                    <label for="savedQueryDescription">Description (Optional)</label>
                                    <textarea id="savedQueryDescription" rows="3" placeholder="Brief description of what this query targets or finds."></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="savedQueryTags">Tags (comma separated)</label>
                                    <input type="text" id="savedQueryTags" placeholder="e.g., recon, filetype, google">
                                </div>
                                <div class="form-group">
                                    <label>Generated Query</label>
                                    <textarea id="savedQueryGenerated" rows="4" readonly style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 8px; padding: 15px; width: 100%; font-family: 'JetBrains Mono', monospace; font-size: 14px;"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="savedQueryEngine">Target Engine</label>
                                    <input type="text" id="savedQueryEngine" readonly class="form-group-input" style="background: var(--bg-tertiary); color: var(--text-primary);">
                                </div>

                                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                                    <button type="button" class="btn btn-secondary" id="cancelSaveDorkQuery">Cancel</button>
                                    <button type="submit" class="btn btn-primary">Save Query</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="modal" id="editExecuteTemplateModal">
                        <div class="modal-content">
                            <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-edit"></i> Edit & Execute Template</h3>
                            <form id="editExecuteTemplateForm">
                                <input type="hidden" id="editExecuteTemplateId">

                                <div class="form-group">
                                    <label for="editExecuteTemplateName">Template Name</label>
                                    <input type="text" id="editExecuteTemplateName" readonly style="background: var(--bg-tertiary); color: var(--text-primary);">
                                </div>
                                <div class="form-group">
                                    <label for="editExecuteTemplateQuery">Query to Edit</label>
                                    <textarea id="editExecuteTemplateQuery" rows="6" style="background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 8px; padding: 15px; width: 100%; font-family: 'JetBrains Mono', monospace; font-size: 14px; resize: vertical;" required></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="editExecuteTemplateEngine">Target Engine</label>
                                    <select id="editExecuteTemplateEngine" class="form-group-input">
                                        <option value="google">Google</option>
                                        <option value="duckduckgo">DuckDuckGo</option>
                                        <option value="bing">Bing</option>
                                        <option value="yandex">Yandex</option>
                                        <option value="shodan">Shodan</option>
                                        <option value="censys">Censys</option>
                                    </select>
                                </div>

                                <div id="editExecuteConversionSection" style="display: none; margin-top: 15px; border: 1px solid var(--border); border-radius: 8px; padding: 15px; background: var(--bg-tertiary);">
                                    <p style="margin-bottom: 10px; color: var(--text-primary);">
                                        The selected engine is Shodan or Censys. Click below to convert your query to the appropriate syntax.
                                    </p>
                                    <button type="button" class="btn btn-secondary btn-sm" id="performEditExecuteConversionBtn" style="width: 100%;">
                                        <i class="fas fa-magic"></i> Convert Query to Shodan/Censys
                                    </button>
                                </div>
                                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                                    <button type="button" class="btn btn-secondary" id="cancelEditExecuteTemplate">Cancel</button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-play"></i> Execute Query
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="modal" id="dorkWarningModal">
                        <div class="modal-content">
                            <h3 style="margin-bottom: 20px; color: var(--warning);"><i class="fas fa-exclamation-triangle"></i> Query Engine Mismatch Warning</h3>
                            <p id="dorkWarningMessage" style="margin-bottom: 25px; color: var(--text-primary); line-height: 1.6;">
                                </p>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" id="cancelDorkWarning">Cancel</button>
                                <button type="button" class="btn btn-warning" id="convertAndGoToPlayground">
                                    <i class="fas fa-magic"></i> Convert Query Here
                                </button>
                                <button type="button" class="btn btn-primary" id="continueDorkExecution">
                                    <i class="fas fa-play"></i> Continue Anyway
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="timelineTab">
                    <div class="content-header">
                        <h2 class="content-title">Investigation Timeline</h2>
                        <div class="controls">
                            <button class="btn btn-primary" id="addTimelineEventBtn">
                                <i class="fas fa-plus-circle"></i> Add Event
                            </button>
                            <button class="btn btn-secondary" id="exportTimelineBtn">
                                <i class="fas fa-download"></i> Export Timeline
                            </button>
                            <button class="btn btn-secondary" id="importTimelineBtn">
                                <i class="fas fa-upload"></i> Import Timeline
                            </button>
                        </div>
                    </div>

                    <div id="timeline-events-display">
                        <div class="empty-state" id="emptyTimelineState" style="display: none;">
                            <i class="fas fa-clock"></i>
                            <h3>No Events Yet</h3>
                            <p>Start by adding your first investigation event!</p>
                            <button class="btn2 btn-primary" id="addEventBtnEmptyState">
                                Add First Event
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="case-studiesTab">
                    <div class="content-header">
                        <h2 class="content-title">Cyber Investigation Case Studies</h2>
                        <div class="controls">
                            <input type="text" id="caseStudySearchInput" class="search-input" placeholder="Search case studies..." style="max-width: 300px; margin-right: 10px;">
                            <select id="caseStudyFilterSelect" class="form-group-input" style="max-width: 150px; margin-right: 10px;">
                                <option value="">All Types</option>
                                <option value="ransomware">Ransomware</option>
                                <option value="phishing">Phishing</option>
                                <option value="insider-threat">Insider Threat</option>
                                <option value="data-breach">Data Breach</option>
                                <option value="apt">APT Activity</option>
                                <option value="ddos">DDoS Attack</option>
                                <option value="malware">Malware Analysis</option>
                                <option value="fraud">Fraud</option>
                                <option value="other">Other</option>
                                <option value="custom">Custom Type</option>
                            </select>
                            <button class="btn btn-secondary" id="caseStudyViewToggle" title="Switch to List View">
                                <i class="fas fa-list"></i> List View
                            </button>
                            <button class="btn btn-primary" id="addCaseStudyBtn">
                                <i class="fas fa-plus-circle"></i> Add Case Study
                            </button>
                        </div>
                    </div>
                
                    <div class="case-studies-grid" id="caseStudiesGrid">
                    </div>
                    <div class="case-studies-list" id="caseStudiesList" style="display: none;">
                        </div>
                
                    <div class="empty-state" id="emptyCaseStudiesState" style="display: none;">
                        <i class="fas fa-book-open"></i>
                        <h3>No Case Studies Found</h3>
                        <p>No cyber investigation case studies match your current criteria.</p>
                        <button class="btn btn-primary" id="addCaseStudyEmptyStateBtn">
                            <i class="fas fa-plus"></i> Add First Case Study
                        </button>
                    </div>
                </div>

                <div class="tab-content" id="threat-huntingTab">
                    <div class="content-header">
                        <h2 class="content-title">Cyber Threat Hunting Toolkit</h2>
                        <div class="controls">
                            <input type="text" id="scriptSearchInput" class="search-input" placeholder="Search scripts..." style="max-width: 300px; margin-right: 10px;">
                            <select id="scriptLanguageFilter" class="form-group-input" style="max-width: 150px; margin-right: 10px;">
                                <option value="">All Languages</option>
                            </select>
                            <button class="btn btn-primary" id="addScriptBtn">
                                <i class="fas fa-plus-circle"></i> Add New Script
                            </button>
                        </div>
                    </div>

                    <div class="sub-nav-tabs">
                        <button class="sub-nav-tab th-subtab active" data-th-subtab="script-library">
                            <i class="fas fa-code"></i> Script Library
                        </button>
                        <button class="sub-nav-tab th-subtab" data-th-subtab="dashboards">
                            <i class="fas fa-chart-bar"></i> Dashboards
                        </button>
                        <button class="sub-nav-tab th-subtab" data-th-subtab="playbooks">
                            <i class="fas fa-book-open"></i> Playbooks
                        </button>
                    </div>

                    <div class="th-subtab-content" id="script-library-content" style="display: block; margin-top: 20px;">
                        <div class="tools-grid" id="scriptLibraryGrid">
                            </div>
                        <div class="empty-state" id="emptyScriptLibraryState" style="display: none;">
                            <i class="fas fa-code"></i>
                            <h3>No Scripts Found</h3>
                            <p>Add your first threat hunting script to get started!</p>
                            <button class="btn btn-primary" id="addScriptEmptyStateBtn">
                                <i class="fas fa-plus"></i> Add First Script
                            </button>
                        </div>
                    </div>

                    <div class="th-subtab-content" id="dashboards-content" style="display: none; margin-top: 20px;">
                        <div class="empty-state">
                            <i class="fas fa-chart-line"></i>
                            <h3>Dashboards (Coming Soon)</h3>
                            <p>This section will feature interactive dashboards for threat hunting, such as visualizing common attack patterns or network anomalies (requires external services or more complex client-side charting).</p>
                        </div>
                    </div>

                    <div class="th-subtab-content" id="playbooks-content" style="display: none; margin-top: 20px;">
                        <div class="empty-state">
                            <i class="fas fa-book-open"></i>
                            <h3>Hunting Playbooks (Coming Soon)</h3>
                            <p>A collection of step-by-step guides for various threat hunting scenarios, outlining techniques, tools, and expected outcomes.</p>
                        </div>
                    </div>
                </div>


                <div class="modal" id="addEventModal">
                    <div class="modal-content">
                        <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-plus-circle"></i> Add New Timeline Event</h3>
                        <form id="addEventForm">
                            <input type="hidden" id="editEventId">
                            <div class="form-group">
                                <label for="eventTimestamp">Timestamp</label>
                                <input type="datetime-local" id="eventTimestamp" required>
                            </div>
                            <div class="form-group">
                                <label for="eventTitle">Title</label>
                                <input type="text" id="eventTitle" maxlength="100" placeholder="e.g., Phishing email received" required>
                            </div>
                            <div class="form-group">
                                <label for="eventCategory">Category</label>
                                <select id="eventCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="phishing">Phishing</option>
                                    <option value="initial_access">Initial Access</option>
                                    <option value="lateral_movement">Lateral Movement</option>
                                    <option value="exfiltration">Data Exfiltration</option>
                                    <option value="command_control">Command & Control</option>
                                    <option value="reconnaissance">Reconnaissance</option>
                                    <option value="malware_delivery">Malware Delivery</option>
                                    <option value="persistence">Persistence</option>
                                    <option value="privilege_escalation">Privilege Escalation</option>
                                    <option value="defense_evasion">Defense Evasion</option>
                                    <option value="credential_access">Credential Access</option>
                                    <option value="discovery">Discovery</option>
                                    <option value="collection">Collection</option>
                                    <option value="impact">Impact</option>
                                    <option value="remediation">Remediation</option>
                                    <option value="fraud">Financial Fraud</option>
                                    <option value="insider_threat">Insider Threat</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="eventNotes">Notes</label>
                                <textarea id="eventNotes" rows="4" placeholder="Detailed notes about the event, observations, etc."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="eventConfidence">Confidence / Severity</label>
                                <select id="eventConfidence" required>
                                    <option value="low">Low</option>
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                    <option value="critical">Critical</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="eventEvidence">Evidence Link / Reference</label>
                                <input type="text" id="eventEvidence" placeholder="URL, file hash, log entry ID, etc.">
                            </div>
                            <div class="form-group">
                                <label for="eventActor">Actor (Optional)</label>
                                <input type="text" id="eventActor" placeholder="e.g., Attacker, Victim, APT28, Employee X">
                            </div>

                            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                                <button type="button" class="btn btn-secondary" id="cancelAddEvent">Cancel</button>
                                <button type="submit" class="btn btn-primary" id="saveEventBtn">Add Event</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="modal" id="importTimelineModal">
                    <div class="modal-content">
                        <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-upload"></i> Import Timeline</h3>
                        <p style="margin-bottom: 15px; color: var(--text-primary);">
                            Upload a JSON file containing timeline data.
                        </p>
                        <div class="form-group">
                            <label for="importTimelineFile">Choose JSON File</label>
                            <input type="file" id="importTimelineFile" accept=".json" required>
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                            <button type="button" class="btn btn-secondary" id="cancelImportTimeline">Cancel</button>
                            <button type="button" class="btn btn-primary" id="confirmImportTimeline">Import</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <section class="investigation-wall">
            <div class="wall-texture"></div>
            <div class="floating-particles" id="particles"></div>
            <div class="connecting-lines" id="connecting-lines"></div>
    
            <div class="wall-header">
                <h1 class="section-title">
                    OSINT Investigation Hub
                </h1>
                <p class="section-subtitle">
                    Intelligence Gathering & Analysis Techniques
                </p>
            </div>
    
            <div class="evidence-container">
                <div class="evidence-grid">
                    <div class="evidence-card" data-category="search">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="card-title">Advanced Search Techniques</div>
                        </div>
                        <div class="card-content">
                            Master <span class="highlight">Google Dorks</span> with operators like site:, filetype:, and intitle:. Use <span class="highlight">Boolean logic</span> with AND, OR, NOT. Combine with quotation marks for exact phrase matching and minus operator for exclusions.
                        </div>
                    </div>
    
                    <div class="evidence-card" data-category="social">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="card-title">Social Media Intelligence</div>
                        </div>
                        <div class="card-content">
                            Extract <span class="highlight">EXIF metadata</span> from images. Perform reverse image searches across platforms. Track <span class="highlight">username patterns</span> and cross-reference profile information for digital footprint mapping.
                        </div>
                    </div>
    
                    <div class="evidence-card" data-category="documentation">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-file-shield"></i>
                            </div>
                            <div class="card-title">Evidence Documentation</div>
                        </div>
                        <div class="card-content">
                            Create <span class="highlight">timestamped screenshots</span> with metadata. Use archive.org for historical data. Maintain detailed <span class="highlight">chain of custody</span> documentation for legal admissibility.
                        </div>
                    </div>
    
                    <div class="evidence-card" data-category="digital">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-fingerprint"></i>
                            </div>
                            <div class="card-title">Digital Footprint Analysis</div>
                        </div>
                        <div class="card-content">
                            Analyze <span class="highlight">WHOIS records</span> and DNS data. Use Shodan for IoT device discovery. Examine <span class="highlight">SSL certificates</span> and email headers for routing intelligence and infrastructure mapping.
                        </div>
                    </div>
    
                    <div class="evidence-card" data-category="security">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-user-secret"></i>
                            </div>
                            <div class="card-title">Operational Security</div>
                        </div>
                        <div class="card-content">
                            Use <span class="highlight">VPN + Tor</span> for anonymity layers. Create isolated investigation personas. Always use <span class="highlight">burner accounts</span> and clean browser sessions for operational integrity.
                        </div>
                    </div>
    
                    <div class="evidence-card" data-category="verification">
                        <div class="card-header">
                            <div class="card-icon">
                                <i class="fas fa-shield-check"></i>
                            </div>
                            <div class="card-title">Information Verification</div>
                        </div>
                        <div class="card-content">
                            Implement <span class="highlight">multi-source verification</span> protocols. Use geolocation tools and timestamp analysis. Detect <span class="highlight">deepfakes</span> and manipulated media through technical analysis.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="modal" id="desktopRecommendationModal">
            <div class="modal-content">
                <h3 style="margin-bottom: 20px; color: var(--warning);"><i class="fas fa-desktop"></i> Attention: Desktop Recommended</h3>
                <p style="margin-bottom: 15px; color: var(--text-primary);">
                    OSINTVault is primarily designed for desktop use to provide the best experience and access to all features. For optimal functionality, please access this tool on a larger screen.
                </p>
                <p style="margin-bottom: 25px; color: var(--text-secondary);">
                    You can still proceed, but some options may not be fully visible or functional on smaller screens.
                </p>
                <div style="display: flex; justify-content: flex-end;">
                    <button type="button" class="btn btn-primary" id="continueAnywayBtn">
                        <i class="fas fa-arrow-right"></i> Continue Anyway
                    </button>
                </div>
            </div>
        </div>


        <div class="modal" id="addToolOnlyModal">
            <div class="modal-content">
                <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-plus-circle"></i> Add New Tool</h3>
                <form id="addToolOnlyForm">
                    <div class="form-group">
                        <label>Tool Name</label>
                        <input type="text" id="toolOnlyName" name="toolOnlyName" maxlength="50" placeholder="e.g., Maltego, Shodan, Recon-NG" required>
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="toolOnlyUrl" name="toolOnlyUrl" required>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="toolOnlyCategory" required>
                            <option value="">Select Category</option>
                            </select>
                        <input type="text" id="newToolOnlyCategoryInput" placeholder="Or enter new category" style="margin-top: 10px; display: none;">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="toolOnlyDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="toolOnlyTags" placeholder="osint, investigation, cybersecurity">
                    </div>

                    <div class="custom-tab-assignment" id="intelligenceVaultCategoriesAssignmentAddTool">
                        <h4>Add to Intelligence Vault Categories</h4>
                        <p style="font-size: 0.9em; color: var(--text-muted); margin-bottom: 10px;">Select one or more intelligence categories for this tool.</p>
                    
                        <div class="form-group" style="margin-bottom: 15px;">
                            <div style="position: relative;">
                                <input type="text" id="intelligenceVaultCategorySearch" class="search-input" placeholder="Search categories..." style="padding-right: 40px;">
                                <i class="fas fa-search search-icon" style="right: 15px;"></i>
                            </div>
                        </div>
                    
                        <div class="custom-tab-checkboxes-container" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; border-radius: 8px; background: var(--bg-secondary);">
                            <div class="custom-tab-checkboxes" id="intelligenceVaultCategoriesCheckboxesAddTool">
                                </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn btn-secondary" id="cancelAddToolOnly">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add Tool</button>
                    </div>
                </form>
            </div>
        </div>

        <section class="discovery-section">
            <div class="random-display" id="randomDiscovery">
                <div class="random-display-header">
                    <span class="header-icon"><i class="fas fa-magic"></i></span>
                    <h3 class="header-text">Daily OSINT Discovery</h3>
                </div>
                <div id="randomItemDisplay" class="random-content-wrapper">
                    <div class="random-content-card placeholder">
                        <i class="fas fa-question-circle"></i>
                        <h4 class="card-title">Loading Discovery...</h4>
                        <p class="card-description">Please wait.</p>
                    </div>
                </div>
            </div>
            <button class="btn btn-secondary btn-sm" id="newRandomBtn">
                <i class="fas fa-sync-alt"></i> New Discovery
            </button>
        </section>


        <footer>
            <div class="footer-content">
                <div class="demo-content">
                    <h1>Your OSINT tools, always with you.</h1>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        &copy; 2025 OSINTVault. Designed for OSINT, cybersecurity analysts, cybersecurity professionals and researchers.
                    </p>
                    <p style="color: var(--text-muted); font-size: 0.875rem;">
                        • Responsive design • Dark/Light mode • Modern aesthetics • Tactical feel
                    </p>
                </div>
            </div>
        </footer>
    </div>



    <div class="modal" id="addEntryModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-plus-circle"></i> Add New Entry</h3>
            <form id="addEntryForm">
                <div class="form-group">
                    <label>Entry Type</label>
                    <select id="entryTypeSelect">
                        <option value="tool">Tool</option>
                        <option value="email">Email Address</option>
                        <option value="phone">Phone Number</option>
                        <option value="crypto">Crypto Transaction</option>
                        <option value="location">Location</option>
                        <option value="link">Social / Internet Link</option>
                        <option value="media">Image / Video</option>
                        <option value="password">Password</option>
                        <option value="keyword">Keyword</option>
                        <option value="social">Social Media Profile</option>

                        <option value="domain">Domain/IP/URL</option>
                        <option value="username">Username/Handle</option>
                        <option value="threat">Threat Intelligence</option>
                        <option value="vulnerability">Vulnerability</option>
                        <option value="malware">Malware/File</option>
                        <option value="breach">Data Breach</option>
                        <option value="credential">Credential Dump</option>
                        <option value="forum">Forum/Market</option>
                        <option value="vendor">Underground Vendor</option>
                        <option value="telegram">Telegram Channel</option>
                        <option value="paste">Paste Site</option>
                        <option value="document">Document</option>
                        <option value="network">Network Analysis</option>
                        <option value="metadata">Metadata</option>
                        <option value="archive">Archive/Cache</option>
                        <option value="messaging">Messaging App</option>
                        <option value="dating">Dating Profile</option>
                        <option value="audio">Audio File</option>
                        <option value="facial">Facial Recognition</option>
                        <option value="persona">Persona/Identity</option>
                        <option value="vpn">VPN/Anonymity</option>
                        <option value="honeypot">Honeypot</option>
                        <option value="exploit">Exploit/Market</option>
                        <option value="publicrecord">Public Record</option>
                    </select>
                </div>
                
                <div id="addToolFields" class="entry-fields">
                    <div class="form-group">
                        <label>Tool Name</label>
                        <input type="text" id="toolName" name="toolName" maxlength="50" placeholder="e.g., Maltego, Shodan, Recon-NG">
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="toolUrl" name="toolUrl">
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="toolCategory">
                            <option value="">Select Category</option>
                        </select>
                        <input type="text" id="newCategoryInput" placeholder="Or enter new category" style="margin-top: 10px; display: none;">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="toolDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="toolTags" placeholder="osint, investigation, cybersecurity">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="toolInvestigationNotes" rows="3" placeholder="Any specific notes or observations about this tool in your investigation."></textarea>
                    </div>
                </div>
                
                <div id="addEmailFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="emailAddress" name="emailAddress" maxlength="60">
                    </div>
                    <div class="form-group">
                        <label>Linked Platforms (comma separated)</label>
                        <input type="text" id="emailLinkedPlatforms" placeholder="facebook, instagram">
                    </div>
                    <div class="form-group">
                        <label>Breach Check Results</label>
                        <input type="text" id="emailBreachResults" placeholder="HIBP: Pwned, No breach found">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="emailDescription" rows="3" placeholder="Brief description of the email's context or significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="emailNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addPhoneFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="text" id="phoneNumber" maxlength="15" name="phoneNumber" placeholder="e.g., +1-234-567-8901">
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="phoneType">
                            <option value="mobile">Mobile</option>
                            <option value="landline">Landline</option>
                            <option value="voip">VoIP</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="phoneLocation" placeholder="e.g., City, State, Country">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="phoneDescription" rows="3" placeholder="Brief description of the phone number's context."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="phoneNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addCryptoFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Crypto Address</label>
                        <input type="text" id="cryptoAddress" name="cryptoAddress" maxlength="120" placeholder="e.g., 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa">
                    </div>
                    <div class="form-group">
                        <label>Transaction ID (TXID)</label>
                        <input type="text" id="cryptoTxid" name="cryptoTxid">
                    </div>
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" step="0.00000001" id="cryptoAmount" name="cryptoAmount" placeholder="e.g., 0.005 BTC">
                    </div>
                    <div class="form-group">
                        <label>Source</label>
                        <input type="text" id="cryptoSource" placeholder="exchange, darkweb, personal" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="cryptoTags" placeholder="suspicious, darkweb, stolen">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="cryptoDescription" rows="3" placeholder="Brief description of the transaction or address's significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="cryptoNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addLocationFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Location Name</label>
                        <input type="text" id="locationName" name="locationName" placeholder="e.g., Target building, Suspect's residence" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Coordinates (Lat, Long)</label>
                        <input type="text" id="locationCoordinates" name="locationCoordinates" placeholder="e.g., 34.0522, -118.2437">
                    </div>
                    <div class="form-group">
                        <label>Map Link</label>
                        <input type="url" id="locationMapLink" placeholder="e.g., Google Maps link">
                    </div>
                    <div class="form-group">
                        <label>Possible IP/Geo Intel</label>
                        <input type="text" id="locationIpGeoIntel" placeholder="e.g., 192.168.1.1, ISP provider, Country">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="locationDescription" rows="3" placeholder="Brief description of the location's relevance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="locationNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addLinkFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="linkUrl" name="linkUrl" placeholder="e.g., https://twitter.com/suspectprofile">
                    </div>
                    <div class="form-group">
                        <label>Platform/Type</label>
                        <input type="text" id="linkPlatform" placeholder="twitter, reddit, pastebin, forum" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="linkTags" placeholder="profile, leaked-content, social-engineering">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="linkDescription" rows="3" placeholder="Brief description of what the link contains or its significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="linkNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addMediaFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="mediaTitle" name="mediaTitle" maxlength="50" placeholder="e.g., Suspect Photo, Video Evidence">
                    </div>
                    <div class="form-group">
                        <label>Media Type</label>
                        <select id="mediaType">
                            <option value="image">Image</option>
                            <option value="video">Video</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Upload File (Local Only)</label>
                        <input type="file" id="mediaFile" accept="image/*,video/*">
                        <input type="hidden" id="mediaBase64Data"> <small style="color: var(--text-muted);">For local storage only. File will be base64 encoded.</small>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="mediaDescription" rows="3" placeholder="Brief description of the media content."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="mediaNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addPasswordFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Associated Service/Website</label>
                        <input type="text" id="passwordService" name="passwordService" placeholder="e.g., Facebook, Gmail, Database">
                    </div>
                    <div class="form-group">
                        <label>Username/Email</label>
                        <input type="text" id="passwordUsername" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="text" id="passwordValue" placeholder="e.g., P@ssw0rd123!" maxlength="120">
                    </div>
                    <div class="form-group">
                        <label>Strength/Status</label>
                        <input type="text" id="passwordStrength" placeholder="e.g., Weak, Strong, Leaked, Reset">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="passwordDescription" rows="3" placeholder="Context or relevance of this password."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="passwordNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addKeywordFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Keyword/Phrase</label>
                        <input type="text" id="keywordValue" name="keywordValue" placeholder="e.g., 'John Doe', 'Project X', 'Confidential'">
                    </div>
                    <div class="form-group">
                        <label>Context/Category</label>
                        <input type="text" id="keywordContext" placeholder="e.g., Project Name, Person of Interest, Common Alias">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="keywordDescription" rows="3" placeholder="Elaborate on why this keyword is important."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="keywordNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addSocialFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Platform</label>
                        <input type="text" id="socialPlatform" name="socialPlatform" placeholder="e.g., Twitter, Instagram, TikTok">
                    </div>
                    <div class="form-group">
                        <label>Profile URL</label>
                        <input type="url" id="socialUrl" placeholder="e.g., https://twitter.com/suspectprofile">
                    </div>
                    <div class="form-group">
                        <label>Username/Handle</label>
                        <input type="text" id="socialUsername" placeholder="e.g., @suspectprofile" maxlength="60">
                    </div>
                    <div class="form-group">
                        <label>Followers/Following Count</label>
                        <input type="text" id="socialFollowCounts" maxlength="50" placeholder="e.g., 12k followers, 500 following">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="socialDescription" rows="3" placeholder="Overview of the profile's content and activity."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="socialNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addDomainFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Domain/IP/URL</label>
                        <input type="text" id="domainValue" name="domainValue" placeholder="e.g., example.com, 192.168.1.1, https://suspicious-site.com">
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="domainType">
                            <option value="domain">Domain</option>
                            <option value="ip">IP Address</option>
                            <option value="url">URL</option>
                            <option value="subdomain">Subdomain</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Registrar/ISP</label>
                        <input type="text" id="domainRegistrar" placeholder="e.g., GoDaddy, Cloudflare, Comcast">
                    </div>
                    <div class="form-group">
                        <label>Country/Location</label>
                        <input type="text" id="domainLocation" placeholder="e.g., United States, Russia">
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="domainStatus">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="suspicious">Suspicious</option>
                            <option value="malicious">Malicious</option>
                            <option value="parked">Parked</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>WHOIS Info</label>
                        <textarea id="domainWhois" rows="3" placeholder="WHOIS registration details"></textarea>
                    </div>
                    <div class="form-group">
                        <label>DNS Records</label>
                        <textarea id="domainDns" rows="3" placeholder="A, MX, NS, TXT records"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="domainTags" placeholder="phishing, c2, malware, suspicious">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="domainNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addUsernameFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Username/Handle</label>
                        <input type="text" id="usernameValue" name="usernameValue" placeholder="e.g., darkweb_trader, john_doe123" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Platforms Found</label>
                        <textarea id="usernamePlatforms" rows="3" placeholder="List platforms where this username was found"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Associated Email(s)</label>
                        <input type="text" id="usernameEmails" placeholder="email1@domain.com, email2@domain.com">
                    </div>
                    <div class="form-group">
                        <label>Real Name (if known)</label>
                        <input type="text" id="usernameRealName" placeholder="e.g., John Doe" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Activity Level</label>
                        <select id="usernameActivity">
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="usernameDescription" rows="3" placeholder="Elaborate on the significance of this username."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="usernameNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addThreatFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Threat Type</label>
                        <select id="threatType">
                            <option value="malware">Malware</option>
                            <option value="apt">APT Group</option>
                            <option value="ioc">IOC (Indicator of Compromise)</option>
                            <option value="ttp">TTP (Tactics, Techniques, Procedures)</option>
                            <option value="campaign">Campaign</option>
                            <option value="actor">Threat Actor</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Threat Name/ID</label>
                        <input type="text" id="threatName" name="threatName" placeholder="e.g., APT29, WannaCry, Emotet" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Severity Level</label>
                        <select id="threatSeverity">
                            <option value="critical">Critical</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                            <option value="info">Informational</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>IOCs (comma separated)</label>
                        <textarea id="threatIocs" rows="3" placeholder="IP addresses, domains, file hashes, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Target Sectors</label>
                        <input type="text" id="threatTargets" placeholder="e.g., Government, Healthcare, Finance">
                    </div>
                    <div class="form-group">
                        <label>Attribution</label>
                        <input type="text" id="threatAttribution" placeholder="e.g., Nation-state, Criminal group, Unknown">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="threatDescription" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source</label>
                        <input type="text" id="threatSource" placeholder="e.g., MISP, AlienVault OTX, Internal">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="threatNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addVulnerabilityFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>CVE ID</label>
                        <input type="text" id="vulnCve" name="vulnCve" placeholder="e.g., CVE-2023-12345" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label>CVSS Score</label>
                        <input type="number" step="0.1" min="0" max="10" id="vulnCvss" placeholder="e.g., 9.8">
                    </div>
                    <div class="form-group">
                        <label>Affected Software</label>
                        <input type="text" id="vulnSoftware" placeholder="e.g., Apache HTTP Server 2.4.x">
                    </div>
                    <div class="form-group">
                        <label>Vulnerability Type</label>
                        <select id="vulnType">
                            <option value="rce">Remote Code Execution</option>
                            <option value="sqli">SQL Injection</option>
                            <option value="xss">Cross-Site Scripting</option>
                            <option value="privilege">Privilege Escalation</option>
                            <option value="dos">Denial of Service</option>
                            <option value="info">Information Disclosure</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Exploit Available</label>
                        <select id="vulnExploit">
                            <option value="no">No</option>
                            <option value="poc">PoC Available</option>
                            <option value="public">Public Exploit</option>
                            <option value="weaponized">Weaponized</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="vulnDescription" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Mitigation</label>
                        <textarea id="vulnMitigation" rows="3" placeholder="Patches, workarounds, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="vulnNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addMalwareFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>File Name</label>
                        <input type="text" id="malwareFilename" name="malwareFilename" placeholder="e.g., suspicious.exe, document.pdf" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>File Hash (MD5/SHA1/SHA256)</label>
                        <input type="text" id="malwareHash" placeholder="e.g., d41d8cd98f00b204e9800998ecf8427e">
                    </div>
                    <div class="form-group">
                        <label>File Type</label>
                        <select id="malwareType">
                            <option value="executable">Executable (.exe, .dll)</option>
                            <option value="document">Document (.pdf, .doc, .xls)</option>
                            <option value="script">Script (.js, .vbs, .ps1)</option>
                            <option value="archive">Archive (.zip, .rar)</option>
                            <option value="image">Image (.jpg, .png)</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Malware Family</label>
                        <input type="text" id="malwareFamily" placeholder="e.g., Emotet, TrickBot, Ransomware">
                    </div>
                    <div class="form-group">
                        <label>Detection Ratio</label>
                        <input type="text" id="malwareDetection" placeholder="e.g., 45/70 (VirusTotal)">
                    </div>
                    <div class="form-group">
                        <label>Behavior</label>
                        <textarea id="malwareBehavior" rows="4" placeholder="File behavior, network connections, registry changes, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source/Origin</label>
                        <input type="text" id="malwareSource" placeholder="e.g., Email attachment, Drive-by download">
                    </div>
                    <div class="form-group">
                        <label>Analysis Tools Used</label>
                        <input type="text" id="malwareTools" placeholder="e.g., VirusTotal, Hybrid Analysis, Cuckoo">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="malwareNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addBreachFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Company/Organization</label>
                        <input type="text" id="breachCompany" name="breachCompany" placeholder="e.g., Equifax, Target, LinkedIn" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Breach Date</label>
                        <input type="date" id="breachDate">
                    </div>
                    <div class="form-group">
                        <label>Records Affected</label>
                        <input type="number" id="breachRecords" placeholder="e.g., 147000000">
                    </div>
                    <div class="form-group">
                        <label>Data Types Compromised</label>
                        <textarea id="breachDataTypes" rows="3" placeholder="e.g., Names, SSNs, Credit card numbers, Passwords"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Attack Vector</label>
                        <select id="breachVector">
                            <option value="hacking">Hacking/Intrusion</option>
                            <option value="insider">Insider Threat</option>
                            <option value="physical">Physical</option>
                            <option value="malware">Malware</option>
                            <option value="social">Social Engineering</option>
                            <option value="unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="breachStatus">
                            <option value="confirmed">Confirmed</option>
                            <option value="suspected">Suspected</option>
                            <option value="investigating">Under Investigation</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Source/Reference</label>
                        <input type="url" id="breachSource" placeholder="News article, official statement, etc.">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="breachDescription" rows="3" placeholder="Detailed description of the breach incident."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="breachNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addCredentialFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Credential Type</label>
                        <select id="credentialType">
                            <option value="email_password">Email & Password</option>
                            <option value="username_password">Username & Password</option>
                            <option value="api_key">API Key</option>
                            <option value="ssh_key">SSH Key</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Value</label>
                        <textarea id="credentialValue" rows="3" placeholder="e.g., user@example.com:password123, username:password"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Service/Platform</label>
                        <input type="text" id="credentialService" placeholder="e.g., Company X Database, Internal System">
                    </div>
                    <div class="form-group">
                        <label>Breach/Source</label>
                        <input type="text" id="credentialBreachSource" placeholder="e.g., Pastebin, Dark Web Forum, Company Breach">
                    </div>
                    <div class="form-group">
                        <label>Date Found</label>
                        <input type="date" id="credentialDateFound">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="credentialDescription" rows="3" placeholder="Context or relevance of this credential dump."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="credentialNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addForumFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Forum/Market Name</label>
                        <input type="text" id="forumName" name="forumName" placeholder="e.g., BreachForums, Hydra Market" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="forumUrl" placeholder="e.g., http://xyz.onion/forum">
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="forumType">
                            <option value="forum">Forum</option>
                            <option value="market">Marketplace</option>
                            <option value="carding">Carding Forum</option>
                            <option value="hacking">Hacking Forum</option>
                            <option value="ransomware">Ransomware Group</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="forumStatus">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="down">Down/Seized</option>
                            <option value="scam">Scam</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Primary Language</label>
                        <input type="text" id="forumLanguage" placeholder="e.g., English, Russian">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="forumDescription" rows="3" placeholder="Brief description of the forum/market and its primary focus."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="forumNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addVendorFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Vendor Name/Alias</label>
                        <input type="text" id="vendorAlias" name="vendorAlias" placeholder="e.g., 'DarkWebSupply', 'CredsMaster'" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Associated Platforms</label>
                        <textarea id="vendorPlatforms" rows="3" placeholder="e.g., Dark Web Market A, Telegram Channel B, Forum C"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Products/Services</label>
                        <input type="text" id="vendorProducts" placeholder="e.g., Stolen Credentials, Malware, Drugs">
                    </div>
                    <div class="form-group">
                        <label>Reputation Score</label>
                        <input type="text" id="vendorReputation" placeholder="e.g., 4.5/5, High Trust, Scammer">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="vendorDescription" rows="3" placeholder="Detailed description of the vendor's activities and offerings."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="vendorNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addTelegramFields" class="entry-fields">
                    <div class="form-group">
                        <label>Channel Name</label>
                        <input type="text" id="telegramName" name="telegramName" placeholder="e.g., @darkweb_market" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Channel URL</label>
                        <input type="url" id="telegramUrl" placeholder="https://t.me/channelname">
                    </div>
                    <div class="form-group">
                        <label>Channel Type</label>
                        <select id="telegramType">
                            <option value="market">Marketplace</option>
                            <option value="news">News/Info</option>
                            <option value="leak">Data Leaks</option>
                            <option value="hacking">Hacking/Security</option>
                            <option value="crypto">Cryptocurrency</option>
                            <option value="social">Social/Chat</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Subscriber Count</label>
                        <input type="number" id="telegramSubscribers" placeholder="e.g., 15000">
                    </div>
                    <div class="form-group">
                        <label>Language</label>
                        <input type="text" id="telegramLanguage" placeholder="e.g., English, Russian, Spanish" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Activity Level</label>
                        <select id="telegramActivity">
                            <option value="high">High (Daily posts)</option>
                            <option value="medium">Medium (Weekly posts)</option>
                            <option value="low">Low (Occasional posts)</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Content Description</label>
                        <textarea id="telegramContent" rows="3" placeholder="Description of typical content shared"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Admin/Owner Info</label>
                        <input type="text" id="telegramAdmin" placeholder="Known admin usernames or info">
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="telegramTags" placeholder="darkweb, marketplace, leaks, cybercrime">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="telegramNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addPasteFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Paste URL</label>
                        <input type="url" id="pasteUrl" name="pasteUrl" placeholder="e.g., https://pastebin.com/xyz123">
                    </div>
                    <div class="form-group">
                        <label>Source Site</label>
                        <input type="text" id="pasteSourceSite" placeholder="e.g., Pastebin, Pastie, Ghostbin">
                    </div>
                    <div class="form-group">
                        <label>Content Summary</label>
                        <textarea id="pasteContentSummary" rows="3" placeholder="Brief summary of leaked data or text"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Keywords/Indicators</label>
                        <input type="text" id="pasteKeywords" placeholder="e.g., email list, database dump, exploit code">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="pasteDescription" rows="3" placeholder="Detailed description of the paste's content and its relevance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="pasteNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addDocumentFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Document Title/Name</label>
                        <input type="text" id="documentTitle" name="documentTitle" placeholder="e.g., Project Proposal, Leaked Memo" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>File Type</label>
                        <input type="text" id="documentFileType" placeholder="e.g., PDF, DOCX, XLSX, TXT">
                    </div>
                    <div class="form-group">
                        <label>File Hash (MD5/SHA256)</label>
                        <input type="text" id="documentHash" placeholder="e.g., d41d8cd98f00b204e9800998ecf8427e">
                    </div>
                    <div class="form-group">
                        <label>Content Summary</label>
                        <textarea id="documentContentSummary" rows="4" placeholder="Brief summary of document content, key findings"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source/Origin</label>
                        <input type="text" id="documentSource" placeholder="e.g., Email attachment, Public server, Data breach">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="documentDescription" rows="3" placeholder="Detailed description of the document's content and context."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="documentNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addNetworkFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Analysis Subject</label>
                        <input type="text" id="networkSubject" name="networkSubject" placeholder="e.g., 'Target Network Scan', 'Suspect's IP Traffic'" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Type of Analysis</label>
                        <select id="networkType">
                            <option value="scan">Port Scan</option>
                            <option value="traffic">Network Traffic Analysis</option>
                            <option value="dns">DNS Analysis</option>
                            <option value="whois">WHOIS Lookup</option>
                            <option value="fingerprint">Device Fingerprinting</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Key Findings</label>
                        <textarea id="networkFindings" rows="4" placeholder="Open ports, suspicious traffic, identified services, vulnerabilities"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Associated IPs/Domains</label>
                        <textarea id="networkAssociated" rows="3" placeholder="Comma-separated list of IPs, domains, or URLs"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tools Used</label>
                        <input type="text" id="networkTools" placeholder="e.g., Nmap, Wireshark, Shodan">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="networkDescription" rows="3" placeholder="Overall description of the network analysis conducted."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="networkNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addMetadataEntryFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Metadata Title/Context</label>
                        <input type="text" id="metadataTitle" placeholder="e.g., EXIF Data from Image, PDF Creation Info">
                    </div>
                    <p style="color: var(--text-muted); margin-bottom: 15px;">Use the 'Custom Metadata' section below to add key-value pairs for this entry.</p>
                    <div class="form-group">
                        <label>Metadata Description</label>
                        <textarea id="metadataDescription" rows="3" placeholder="A general description of the metadata collected or its context."></textarea>
                    </div>
                    <div class="form-group">
                        <label>File/Source</label>
                        <input type="text" id="metadataFileSource" placeholder="e.g., image.jpg, document.pdf, website header">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="metadataNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addArchiveFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Original URL</label>
                        <input type="url" id="archiveOriginalUrl" name="archiveOriginalUrl" placeholder="e.g., https://example.com/old-page">
                    </div>
                    <div class="form-group">
                        <label>Archived URL/Link</label>
                        <input type="url" id="archiveUrl" name="archiveUrl" placeholder="e.g., https://web.archive.org/web/...">
                    </div>
                    <div class="form-group">
                        <label>Archiving Service</label>
                        <input type="text" id="archiveService" placeholder="e.g., Wayback Machine, Archive.is, Google Cache">
                    </div>
                    <div class="form-group">
                        <label>Timestamp</label>
                        <input type="datetime-local" id="archiveTimestamp">
                    </div>
                    <div class="form-group">
                        <label>Content Summary</label>
                        <textarea id="archiveContentSummary" rows="4" placeholder="Brief summary of the archived content"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="archiveDescription" rows="3" placeholder="Context or relevance of this archived page/content."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="archiveNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addMessagingFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Messaging App</label>
                        <select id="messagingApp">
                            <option value="whatsapp">WhatsApp</option>
                            <option value="telegram">Telegram</option>
                            <option value="signal">Signal</option>
                            <option value="discord">Discord</option>
                            <option value="irc">IRC</option>
                            <option value="matrix">Matrix</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Username/ID</label>
                        <input type="text" id="messagingUsername" name="messagingUsername" placeholder="e.g., @userhandle, +1234567890">
                    </div>
                    <div class="form-group">
                        <label>Channel/Group/Chat ID</label>
                        <input type="text" id="messagingChatId" placeholder="e.g., Group Name, Channel ID">
                    </div>
                    <div class="form-group">
                        <label>Relevant Content</label>
                        <textarea id="messagingContent" rows="4" placeholder="Summary of conversations, key messages, shared files"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="messagingDescription" rows="3" placeholder="Context or relevance of this messaging app entry."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="messagingNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addDatingFields" class="entry-fields">
                    <div class="form-group">
                        <label>Platform</label>
                        <select id="datingPlatform">
                            <option value="tinder">Tinder</option>
                            <option value="bumble">Bumble</option>
                            <option value="match">Match.com</option>
                            <option value="pof">Plenty of Fish</option>
                            <option value="okcupid">OkCupid</option>
                            <option value="hinge">Hinge</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Profile Name/Username</label>
                        <input type="text" id="datingUsername" name="datingUsername" placeholder="e.g., John_D_NYC" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Display Name</label>
                        <input type="text" id="datingDisplayName" placeholder="e.g., John, 28" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Age</label>
                        <input type="number" min="18" max="99" id="datingAge" placeholder="e.g., 28">
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="datingLocation" placeholder="e.g., New York, NY" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Profile Photos</label>
                        <textarea id="datingPhotos" rows="3" placeholder="Description of photos, reverse image search results, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Bio/Description</label>
                        <textarea id="datingBio" rows="3" placeholder="Profile bio or description"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Verification Status</label>
                        <select id="datingVerified">
                            <option value="verified">Verified</option>
                            <option value="unverified">Unverified</option>
                            <option value="unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Suspicious Flags</label>
                        <textarea id="datingSuspicious" rows="3" placeholder="Any red flags or suspicious indicators"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="datingNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addAudioFields" class="entry-fields">
                    <div class="form-group">
                        <label>Audio Title</label>
                        <input type="text" id="audioTitle" name="audioTitle" placeholder="e.g., Phone call recording, Voice message" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>File Format</label>
                        <select id="audioFormat">
                            <option value="mp3">MP3</option>
                            <option value="wav">WAV</option>
                            <option value="m4a">M4A</option>
                            <option value="ogg">OGG</option>
                            <option value="flac">FLAC</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Duration</label>
                        <input type="text" id="audioDuration" placeholder="e.g., 2:30, 45 seconds">
                    </div>
                    <div class="form-group">
                        <label>Quality</label>
                        <select id="audioQuality">
                            <option value="high">High Quality</option>
                            <option value="medium">Medium Quality</option>
                            <option value="low">Low Quality</option>
                            <option value="poor">Poor Quality</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Language(s)</label>
                        <input type="text" id="audioLanguage" placeholder="e.g., English, Spanish, Multiple">
                    </div>
                    <div class="form-group">
                        <label>Transcript</label>
                        <textarea id="audioTranscript" rows="5" placeholder="Transcription of audio content"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Speaker Analysis</label>
                        <textarea id="audioSpeakers" rows="3" placeholder="Number of speakers, gender, accents, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Background Noise</label>
                        <input type="text" id="audioBackground" placeholder="e.g., Traffic, music, office sounds">
                    </div>
                    <div class="form-group">
                        <label>Analysis Tools Used</label>
                        <input type="text" id="audioTools" placeholder="e.g., Audacity, Adobe Audition, Forensic tools">
                    </div>
                    <div class="form-group">
                        <label>Upload File (Local Only)</label>
                        <input type="file" id="audioFile" accept="audio/*">
                        <small>For local storage only. File will be base64 encoded.</small>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="audioDescription" rows="3" placeholder="Detailed description of the audio content and its relevance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="audioNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addFacialFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Subject/Person Identified</label>
                        <input type="text" id="facialSubject" name="facialSubject" placeholder="e.g., John Doe, Suspect 1" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Source Image/Video Description</label>
                        <textarea id="facialSourceDescription" rows="3" placeholder="Where was the image/video found?"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Identified Profiles/Platforms</label>
                        <textarea id="facialIdentifiedProfiles" rows="3" placeholder="e.g., Facebook Profile URL, Instagram Username"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Confidence Score</label>
                        <input type="text" id="facialConfidence" placeholder="e.g., High, 85%">
                    </div>
                    <div class="form-group">
                        <label>Tools Used</label>
                        <input type="text" id="facialToolsUsed" placeholder="e.g., PimEyes, Google Images, Facial Recognition Software">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="facialDescription" rows="3" placeholder="Overall description of the facial recognition finding."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="facialNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addPersonaFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Persona Name/Alias</label>
                        <input type="text" id="personaName" name="personaName" placeholder="e.g., 'Online Gamer X', 'Business Account Y'" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Real Name (if known)</label>
                        <input type="text" id="personaRealName" placeholder="e.g., John Doe" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Associated Usernames/Emails</label>
                        <textarea id="personaAssociatedAccounts" rows="3" placeholder="List all linked usernames, emails, phone numbers"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Bio/Description</label>
                        <textarea id="personaBio" rows="4" placeholder="Profile bio or description of the persona."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Platforms Used</label>
                        <input type="text" id="personaPlatforms" placeholder="e.g., Twitter, Discord, Dark Web Forums">
                    </div>
                    <div class="form-group">
                        <label>Origin/Purpose</label>
                        <input type="text" id="personaOrigin" placeholder="e.g., Scammer, Investigator, Activist">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="personaNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addVpnFields" class="entry-fields">
                    <div class="form-group">
                        <label>Service Name</label>
                        <input type="text" id="vpnName" name="vpnName" placeholder="e.g., NordVPN, Tor Browser, ProtonVPN" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Service Type</label>
                        <select id="vpnType">
                            <option value="vpn">VPN Service</option>
                            <option value="proxy">Proxy</option>
                            <option value="tor">Tor Network</option>
                            <option value="browser">Anonymous Browser</option>
                            <option value="os">Anonymous OS</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Jurisdiction</label>
                        <input type="text" id="vpnJurisdiction" placeholder="e.g., Panama, Switzerland, No logs">
                    </div>
                    <div class="form-group">
                        <label>Logging Policy</label>
                        <select id="vpnLogs">
                            <option value="no-logs">No Logs</option>
                            <option value="minimal">Minimal Logs</option>
                            <option value="connection">Connection Logs</option>
                            <option value="full">Full Logs</option>
                            <option value="unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Payment Methods</label>
                        <input type="text" id="vpnPayment" placeholder="e.g., Bitcoin, Cash, Credit Card">
                    </div>
                    <div class="form-group">
                        <label>Server Locations</label>
                        <input type="text" id="vpnLocations" placeholder="e.g., 60+ countries, Europe only">
                    </div>
                    <div class="form-group">
                        <label>Known Issues/Leaks</label>
                        <textarea id="vpnIssues" rows="3" placeholder="DNS leaks, IP leaks, law enforcement cooperation, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Use Case</label>
                        <select id="vpnUseCase">
                            <option value="investigation">Investigation</option>
                            <option value="target">Used by Target</option>
                            <option value="opsec">Operational Security</option>
                            <option value="testing">Testing</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="vpnDescription" rows="3" placeholder="General description of the VPN service or anonymity tool."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="vpnNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addHoneypotFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Honeypot Type</label>
                        <select id="honeypotType">
                            <option value="low-interaction">Low Interaction</option>
                            <option value="high-interaction">High Interaction</option>
                            <option value="data">Data Honeypot</option>
                            <option value="network">Network Honeypot</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Deployment Location/IP</label>
                        <input type="text" id="honeypotLocation" placeholder="e.g., Public Cloud, 192.168.1.1">
                    </div>
                    <div class="form-group">
                        <label>Purpose</label>
                        <input type="text" id="honeypotPurpose" placeholder="e.g., Malware Analysis, Threat Actor Tracking">
                    </div>
                    <div class="form-group">
                        <label>Captured Data Summary</label>
                        <textarea id="honeypotDataSummary" rows="4" placeholder="Summary of captured attacks, malware, IPs"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Alerts/Indicators</label>
                        <textarea id="honeypotAlerts" rows="3" placeholder="Key indicators or alerts generated"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="honeypotDescription" rows="3" placeholder="Detailed description of the honeypot setup and findings."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="honeypotNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addExploitFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Exploit Name/ID</label>
                        <input type="text" id="exploitName" name="exploitName" placeholder="e.g., EternalBlue, CVE-2023-XXXX" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Target Vulnerability</label>
                        <input type="text" id="exploitTargetVuln" placeholder="e.g., MS17-010, Adobe Flash Zero-Day">
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="exploitType">
                            <option value="rce">Remote Code Execution</option>
                            <option value="privesc">Privilege Escalation</option>
                            <option value="dos">Denial of Service</option>
                            <option value="zero-day">Zero-Day</option>
                            <option value="poc">PoC</option>
                            <option value="weaponized">Weaponized</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Market/Source</label>
                        <input type="text" id="exploitMarketSource" placeholder="e.g., Exploit-DB, Underground Market, Private Sale">
                    </div>
                    <div class="form-group">
                        <label>Price/Value</label>
                        <input type="text" id="exploitPrice" placeholder="e.g., $10,000, 2 BTC">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="exploitDescription" rows="3" placeholder="Technical description of the exploit and its capabilities."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="exploitNotes" rows="3"></textarea>
                    </div>
                </div>
                
                <div id="addPublicRecordFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Record Type</label>
                        <select id="publicRecordType">
                            <option value="court">Court Record</option>
                            <option value="property">Property Record</option>
                            <option value="business">Business Registration</option>
                            <option value="voter">Voter Registration</option>
                            <option value="license">License/Permit</option>
                            <option value="tax">Tax Record</option>
                            <option value="marriage">Marriage/Divorce</option>
                            <option value="birth_death">Birth/Death Certificate</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Subject Name</label>
                        <input type="text" id="publicRecordSubjectName" name="publicRecordSubjectName" placeholder="e.g., John Doe" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Case/Reference ID</label>
                        <input type="text" id="publicRecordRefId" placeholder="e.g., Case #12345, Doc-XYZ">
                    </div>
                    <div class="form-group">
                        <label>Jurisdiction/Location</label>
                        <input type="text" id="publicRecordJurisdiction" placeholder="e.g., New York, NY; Federal Court">
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="publicRecordDate">
                    </div>
                    <div class="form-group">
                        <label>Summary/Key Details</label>
                        <textarea id="publicRecordSummary" rows="4" placeholder="Summary of record content and relevance"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source URL/Location</label>
                        <input type="url" id="publicRecordSourceUrl" placeholder="e.g., official website link">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="publicRecordDescription" rows="3" placeholder="General description of the public record and its significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="publicRecordNotes" rows="3"></textarea>
                    </div>
                </div>

                <div class="form-group" id="entrySourceGroup" style="display: none;">
                    <label>Source (Where was this info collected?)</label>
                    <input type="text" id="entrySource" name="entrySource" placeholder="e.g., public record, social media, dark web forum">
                </div>

                <div id="customMetadataGroup" style="display: none;">
                    <label>Custom Metadata</label>
                    <div id="customMetadataEntries">
                        </div>
                    <button type="button" class="btn btn-secondary btn-sm add-metadata-btn" id="addMetadataBtn">
                        <i class="fas fa-plus"></i> Add Metadata Field
                    </button>
                </div>


                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelAddEntry">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Entry</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="editEntryModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-edit"></i> Edit Entry</h3>
            <form id="editEntryForm">
                <input type="hidden" id="editEntryId">
                <input type="hidden" id="editEntryType">
    
                <div id="editToolFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Tool Name</label>
                        <input type="text" id="editToolName" name="editToolName" maxlength="50" placeholder="e.g., Maltego, Shodan, Recon-NG" required>
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="editToolUrl" name="editToolUrl" required>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="editToolCategory" required>
                            <option value="">Select Category</option>
                        </select>
                        <input type="text" id="editNewCategoryInput" placeholder="Or enter new category" style="margin-top: 10px; display: none;">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editToolDescription" rows="3" placeholder="Brief description of the tool."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="editToolTags" placeholder="osint, investigation, cybersecurity">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editToolInvestigationNotes" rows="3" placeholder="Any specific notes or observations about this tool in your investigation."></textarea>
                    </div>
                    <div class="custom-tab-assignment" id="intelligenceVaultCategoriesAssignmentEditTool">
                        <h4>Add to Intelligence Vault Categories</h4>
                        <p style="font-size: 0.9em; color: var(--text-muted); margin-bottom: 10px;">Select one or more intelligence categories for this tool.</p>
    
                        <div class="form-group" style="margin-bottom: 15px;">
                            <div style="position: relative;">
                                <input type="text" id="editIntelligenceVaultCategorySearch" class="search-input" placeholder="Search categories..." style="padding-right: 40px;">
                                <i class="fas fa-search search-icon" style="right: 15px;"></i>
                            </div>
                        </div>
    
                        <div class="custom-tab-checkboxes-container" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; border-radius: 8px; background: var(--bg-secondary);">
                            <div class="custom-tab-checkboxes" id="intelligenceVaultCategoriesCheckboxesEditTool">
                            </div>
                        </div>
                    </div>
                </div>
    
                <div id="editEmailFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="editEmailAddress" name="editEmailAddress" maxlength="60" required>
                    </div>
                    <div class="form-group">
                        <label>Linked Platforms (comma separated)</label>
                        <input type="text" id="editEmailLinkedPlatforms" placeholder="facebook, instagram">
                    </div>
                    <div class="form-group">
                        <label>Breach Check Results</label>
                        <input type="text" id="editEmailBreachResults" placeholder="HIBP: Pwned, No breach found">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editEmailDescription" rows="3" placeholder="Brief description of the email's context or significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editEmailNotes" rows="3" placeholder="Any specific notes or observations about this email."></textarea>
                    </div>
                </div>
    
                <div id="editPhoneFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="text" id="editPhoneNumber" maxlength="15" name="editPhoneNumber" placeholder="e.g., +1-234-567-8901" required>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="editPhoneType">
                            <option value="mobile">Mobile</option>
                            <option value="landline">Landline</option>
                            <option value="voip">VoIP</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="editPhoneLocation" placeholder="e.g., City, State, Country">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editPhoneDescription" rows="3" placeholder="Brief description of the phone number's context."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editPhoneNotes" rows="3" placeholder="Any specific notes or observations about this phone number."></textarea>
                    </div>
                </div>
    
                <div id="editCryptoFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Crypto Address</label>
                        <input type="text" id="editCryptoAddress" name="editCryptoAddress" maxlength="120" placeholder="e.g., 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa" required>
                    </div>
                    <div class="form-group">
                        <label>Transaction ID (TXID)</label>
                        <input type="text" id="editCryptoTxid" name="editCryptoTxid" required>
                    </div>
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" step="0.00000001" name="editCryptoAmount" id="editCryptoAmount" placeholder="e.g., 0.005 BTC" required>
                    </div>
                    <div class="form-group">
                        <label>Source</label>
                        <input type="text" id="editCryptoSource" placeholder="exchange, darkweb, personal" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="editCryptoTags" placeholder="suspicious, darkweb, stolen">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editCryptoDescription" rows="3" placeholder="Brief description of the transaction or address's significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editCryptoNotes" rows="3" placeholder="Any specific notes or observations about this crypto entry."></textarea>
                    </div>
                </div>
    
                <div id="editLocationFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Location Name</label>
                        <input type="text" id="editLocationName" name="editLocationName" maxlength="50" placeholder="e.g., Target building, Suspect's residence" required>
                    </div>
                    <div class="form-group">
                        <label>Coordinates (Lat, Long)</label>
                        <input type="text" id="editLocationCoordinates" name="editLocationCoordinates" placeholder="e.g., 34.0522, -118.2437" required>
                    </div>
                    <div class="form-group">
                        <label>Map Link</label>
                        <input type="url" id="editLocationMapLink" placeholder="e.g., Google Maps link">
                    </div>
                    <div class="form-group">
                        <label>Possible IP/Geo Intel</label>
                        <input type="text" id="editLocationIpGeoIntel" placeholder="e.g., 192.168.1.1, ISP provider, Country">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editLocationDescription" rows="3" placeholder="Brief description of the location's relevance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editLocationNotes" rows="3" placeholder="Any specific notes or observations about this location."></textarea>
                    </div>
                </div>
    
                <div id="editLinkFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="editLinkUrl" name="editLinkUrl" placeholder="e.g., https://twitter.com/suspectprofile" required>
                    </div>
                    <div class="form-group">
                        <label>Platform/Type</label>
                        <input type="text" id="editLinkPlatform" placeholder="twitter, reddit, pastebin, forum" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="editLinkTags" placeholder="profile, leaked-content, social-engineering">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editLinkDescription" rows="3" placeholder="Brief description of what the link contains or its significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editLinkNotes" rows="3" placeholder="Any specific notes or observations about this link."></textarea>
                    </div>
                </div>
    
                <div id="editMediaFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="editMediaTitle" name="editMediaTitle" maxlength="50" placeholder="e.g., Suspect Photo, Video Evidence" required>
                    </div>
                    <div class="form-group">
                        <label>Media Type</label>
                        <select id="editMediaType">
                            <option value="image">Image</option>
                            <option value="video">Video</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Upload New File (Optional)</label>
                        <input type="file" id="editMediaFile" accept="image/*,video/*">
                        <input type="hidden" id="editMediaBase64Data"> <small style="color: var(--text-muted);">Upload a new file to replace the existing one.</small>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editMediaDescription" rows="3" placeholder="Brief description of the media content."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editMediaNotes" rows="3" placeholder="Any specific notes or observations about this media file."></textarea>
                    </div>
                </div>
    
                <div id="editPasswordFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Associated Service/Website</label>
                        <input type="text" id="editPasswordService" name="editPasswordService" placeholder="e.g., Facebook, Gmail, Database" required>
                    </div>
                    <div class="form-group">
                        <label>Username/Email</label>
                        <input type="text" id="editPasswordUsername" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="text" id="editPasswordValue" placeholder="e.g., P@ssw0rd123!" maxlength="120" required>
                    </div>
                    <div class="form-group">
                        <label>Strength/Status</label>
                        <input type="text" id="editPasswordStrength" placeholder="e.g., Weak, Strong, Leaked, Reset">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editPasswordDescription" rows="3" placeholder="Context or relevance of this password."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editPasswordNotes" rows="3" placeholder="Any specific notes or observations about this password."></textarea>
                    </div>
                </div>
    
                <div id="editKeywordFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Keyword/Phrase</label>
                        <input type="text" id="editKeywordValue" name="editKeywordValue" placeholder="e.g., 'John Doe', 'Project X', 'Confidential'" required>
                    </div>
                    <div class="form-group">
                        <label>Context/Category</label>
                        <input type="text" id="editKeywordContext" placeholder="e.g., Project Name, Person of Interest, Common Alias">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editKeywordDescription" rows="3" placeholder="Elaborate on why this keyword is important."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editKeywordNotes" rows="3" placeholder="Any specific notes or observations about this keyword."></textarea>
                    </div>
                </div>
    
                <div id="editSocialFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Platform</label>
                        <input type="text" id="editSocialPlatform" name="editSocialPlatform" placeholder="e.g., Twitter, Instagram, TikTok" required>
                    </div>
                    <div class="form-group">
                        <label>Profile URL</label>
                        <input type="url" id="editSocialUrl" placeholder="e.g., https://twitter.com/suspectprofile" required>
                    </div>
                    <div class="form-group">
                        <label>Username/Handle</label>
                        <input type="text" id="editSocialUsername" placeholder="e.g., @suspectprofile" maxlength="60" required>
                    </div>
                    <div class="form-group">
                        <label>Followers/Following Count</label>
                        <input type="text" id="editSocialFollowCounts" maxlength="50" placeholder="e.g., 12k followers, 500 following">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editSocialDescription" rows="3" placeholder="Overview of the profile's content and activity."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editSocialNotes" rows="3" placeholder="Any specific notes or observations about this social profile."></textarea>
                    </div>
                </div>
    
                <div id="editDomainFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Domain/IP/URL</label>
                        <input type="text" id="editDomainValue" name="editDomainValue" placeholder="e.g., example.com, 192.168.1.1, https://suspicious-site.com" required>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="editDomainType" required>
                            <option value="domain">Domain</option>
                            <option value="ip">IP Address</option>
                            <option value="url">URL</option>
                            <option value="subdomain">Subdomain</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Registrar/ISP</label>
                        <input type="text" id="editDomainRegistrar" placeholder="e.g., GoDaddy, Cloudflare, Comcast">
                    </div>
                    <div class="form-group">
                        <label>Country/Location</label>
                        <input type="text" id="editDomainLocation" placeholder="e.g., United States, Russia">
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="editDomainStatus">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="suspicious">Suspicious</option>
                            <option value="malicious">Malicious</option>
                            <option value="parked">Parked</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>WHOIS Info</label>
                        <textarea id="editDomainWhois" rows="3" placeholder="WHOIS registration details"></textarea>
                    </div>
                    <div class="form-group">
                        <label>DNS Records</label>
                        <textarea id="editDomainDns" rows="3" placeholder="A, MX, NS, TXT records"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tags (comma separated)</label>
                        <input type="text" id="editDomainTags" placeholder="phishing, c2, malware, suspicious">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editDomainDescription" rows="3" placeholder="Brief description of the domain/IP/URL's relevance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editDomainNotes" rows="3" placeholder="Any specific notes or observations about this domain/IP/URL."></textarea>
                    </div>
                </div>
    
                <div id="editUsernameFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Username/Handle</label>
                        <input type="text" id="editUsernameValue" name="editUsernameValue" placeholder="e.g., darkweb_trader, john_doe123" maxlength="50" required>
                    </div>
                    <div class="form-group">
                        <label>Platforms Found</label>
                        <textarea id="editUsernamePlatforms" rows="3" placeholder="List platforms where this username was found"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Associated Email(s)</label>
                        <input type="text" id="editUsernameEmails" placeholder="email1@domain.com, email2@domain.com">
                    </div>
                    <div class="form-group">
                        <label>Real Name (if known)</label>
                        <input type="text" id="editUsernameRealName" placeholder="e.g., John Doe" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label>Activity Level</label>
                        <select id="editUsernameActivity">
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editUsernameDescription" rows="3" placeholder="Elaborate on the significance of this username."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editUsernameNotes" rows="3" placeholder="Any specific notes or observations about this username."></textarea>
                    </div>
                </div>
    
                <div id="editThreatFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Threat Type</label>
                        <select id="editThreatType" required>
                            <option value="malware">Malware</option>
                            <option value="apt">APT Group</option>
                            <option value="ioc">IOC (Indicator of Compromise)</option>
                            <option value="ttp">TTP (Tactics, Techniques, Procedures)</option>
                            <option value="campaign">Campaign</option>
                            <option value="actor">Threat Actor</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Threat Name/ID</label>
                        <input type="text" id="editThreatName" name="editThreatName" placeholder="e.g., APT29, WannaCry, Emotet" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Severity Level</label>
                        <select id="editThreatSeverity">
                            <option value="critical">Critical</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                            <option value="info">Informational</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>IOCs (comma separated)</label>
                        <textarea id="editThreatIocs" rows="3" placeholder="IP addresses, domains, file hashes, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Target Sectors</label>
                        <input type="text" id="editThreatTargets" placeholder="e.g., Government, Healthcare, Finance">
                    </div>
                    <div class="form-group">
                        <label>Attribution</label>
                        <input type="text" id="editThreatAttribution" placeholder="e.g., Nation-state, Criminal group, Unknown">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editThreatDescription" rows="4" placeholder="Detailed description of the threat."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source</label>
                        <input type="text" id="editThreatSource" placeholder="e.g., MISP, AlienVault OTX, Internal">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editThreatNotes" rows="3" placeholder="Any specific notes or observations about this threat intelligence."></textarea>
                    </div>
                </div>
    
                <div id="editVulnerabilityFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>CVE ID</label>
                        <input type="text" id="editVulnCve" name="editVulnCve" placeholder="e.g., CVE-2023-12345" maxlength="20" required>
                    </div>
                    <div class="form-group">
                        <label>CVSS Score</label>
                        <input type="number" step="0.1" min="0" max="10" id="editVulnCvss" placeholder="e.g., 9.8">
                    </div>
                    <div class="form-group">
                        <label>Affected Software</label>
                        <input type="text" id="editVulnSoftware" placeholder="e.g., Apache HTTP Server 2.4.x">
                    </div>
                    <div class="form-group">
                        <label>Vulnerability Type</label>
                        <select id="editVulnType">
                            <option value="rce">Remote Code Execution</option>
                            <option value="sqli">SQL Injection</option>
                            <option value="xss">Cross-Site Scripting</option>
                            <option value="privilege">Privilege Escalation</option>
                            <option value="dos">Denial of Service</option>
                            <option value="info">Information Disclosure</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Exploit Available</label>
                        <select id="editVulnExploit">
                            <option value="no">No</option>
                            <option value="poc">PoC Available</option>
                            <option value="public">Public Exploit</option>
                            <option value="weaponized">Weaponized</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editVulnDescription" rows="4" placeholder="Detailed description of the vulnerability."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Mitigation</label>
                        <textarea id="editVulnMitigation" rows="3" placeholder="Patches, workarounds, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editVulnNotes" rows="3" placeholder="Any specific notes or observations about this vulnerability."></textarea>
                    </div>
                </div>
    
                <div id="editMalwareFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>File Name</label>
                        <input type="text" id="editMalwareFilename" name="editMalwareFilename" placeholder="e.g., suspicious.exe, document.pdf" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>File Hash (MD5/SHA1/SHA256)</label>
                        <input type="text" id="editMalwareHash" placeholder="e.g., d41d8cd98f00b204e9800998ecf8427e">
                    </div>
                    <div class="form-group">
                        <label>File Type</label>
                        <select id="editMalwareType">
                            <option value="executable">Executable (.exe, .dll)</option>
                            <option value="document">Document (.pdf, .doc, .xls)</option>
                            <option value="script">Script (.js, .vbs, .ps1)</option>
                            <option value="archive">Archive (.zip, .rar)</option>
                            <option value="image">Image (.jpg, .png)</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Malware Family</label>
                        <input type="text" id="editMalwareFamily" placeholder="e.g., Emotet, TrickBot, Ransomware">
                    </div>
                    <div class="form-group">
                        <label>Detection Ratio</label>
                        <input type="text" id="editMalwareDetection" placeholder="e.g., 45/70 (VirusTotal)">
                    </div>
                    <div class="form-group">
                        <label>Behavior</label>
                        <textarea id="editMalwareBehavior" rows="4" placeholder="File behavior, network connections, registry changes, etc."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source/Origin</label>
                        <input type="text" id="editMalwareSource" placeholder="e.g., Email attachment, Drive-by download">
                    </div>
                    <div class="form-group">
                        <label>Analysis Tools Used</label>
                        <input type="text" id="editMalwareTools" placeholder="e.g., VirusTotal, Hybrid Analysis, Cuckoo">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editMalwareNotes" rows="3" placeholder="Any specific notes or observations about this malware."></textarea>
                    </div>
                </div>
    
                <div id="editBreachFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Company/Organization</label>
                        <input type="text" id="editBreachCompany" name="editBreachCompany" placeholder="e.g., Equifax, Target, LinkedIn" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Breach Date</label>
                        <input type="date" id="editBreachDate" required>
                    </div>
                    <div class="form-group">
                        <label>Records Affected</label>
                        <input type="number" id="editBreachRecords" placeholder="e.g., 147000000">
                    </div>
                    <div class="form-group">
                        <label>Data Types Compromised</label>
                        <textarea id="editBreachDataTypes" rows="3" placeholder="e.g., Names, SSNs, Credit card numbers, Passwords"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Attack Vector</label>
                        <select id="editBreachVector">
                            <option value="hacking">Hacking/Intrusion</option>
                            <option value="insider">Insider Threat</option>
                            <option value="physical">Physical</option>
                            <option value="malware">Malware</option>
                            <option value="social">Social Engineering</option>
                            <option value="unknown">Unknown</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="editBreachStatus">
                            <option value="confirmed">Confirmed</option>
                            <option value="suspected">Suspected</option>
                            <option value="investigating">Under Investigation</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Source/Reference</label>
                        <input type="url" id="editBreachSource" placeholder="News article, official statement, etc.">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editBreachDescription" rows="3" placeholder="Detailed description of the breach incident."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editBreachNotes" rows="3" placeholder="Any specific notes or observations about this data breach."></textarea>
                    </div>
                </div>
    
                <div id="editCredentialFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Credential Type</label>
                        <select id="editCredentialType">
                            <option value="email_password">Email & Password</option>
                            <option value="username_password">Username & Password</option>
                            <option value="api_key">API Key</option>
                            <option value="ssh_key">SSH Key</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Value</label>
                        <textarea id="editCredentialValue" rows="3" placeholder="e.g., user@example.com:password123, username:password" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Service/Platform</label>
                        <input type="text" id="editCredentialService" placeholder="e.g., Company X Database, Internal System">
                    </div>
                    <div class="form-group">
                        <label>Breach/Source</label>
                        <input type="text" id="editCredentialBreachSource" placeholder="e.g., Pastebin, Dark Web Forum, Company Breach">
                    </div>
                    <div class="form-group">
                        <label>Date Found</label>
                        <input type="date" id="editCredentialDateFound">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editCredentialDescription" rows="3" placeholder="Context or relevance of this credential dump."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editCredentialNotes" rows="3" placeholder="Any specific notes or observations about this credential."></textarea>
                    </div>
                </div>
    
                <div id="editForumFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Forum/Market Name</label>
                        <input type="text" id="editForumName" name="editForumName" placeholder="e.g., BreachForums, Hydra Market" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>URL</label>
                        <input type="url" id="editForumUrl" placeholder="e.g., http://xyz.onion/forum" required>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="editForumType">
                            <option value="forum">Forum</option>
                            <option value="market">Marketplace</option>
                            <option value="carding">Carding Forum</option>
                            <option value="hacking">Hacking Forum</option>
                            <option value="ransomware">Ransomware Group</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="editForumStatus">
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="down">Down/Seized</option>
                            <option value="scam">Scam</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Primary Language</label>
                        <input type="text" id="editForumLanguage" placeholder="e.g., English, Russian">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editForumDescription" rows="3" placeholder="Brief description of the forum/market and its primary focus."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editForumNotes" rows="3" placeholder="Any specific notes or observations about this forum/market."></textarea>
                    </div>
                </div>
    
                <div id="editVendorFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Vendor Name/Alias</label>
                        <input type="text" id="editVendorAlias" name="editVendorAlias" placeholder="e.g., 'DarkWebSupply', 'CredsMaster'" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Associated Platforms</label>
                        <textarea id="editVendorPlatforms" rows="3" placeholder="e.g., Dark Web Market A, Telegram Channel B, Forum C"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Products/Services</label>
                        <input type="text" id="editVendorProducts" placeholder="e.g., Stolen Credentials, Malware, Drugs">
                    </div>
                    <div class="form-group">
                        <label>Reputation Score</label>
                        <input type="text" id="editVendorReputation" placeholder="e.g., 4.5/5, High Trust, Scammer">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editVendorDescription" rows="3" placeholder="Detailed description of the vendor's activities and offerings."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editVendorNotes" rows="3" placeholder="Any specific notes or observations about this vendor."></textarea>
                    </div>
                </div>
    
                <div id="editPasteFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Paste URL</label>
                        <input type="url" id="editPasteUrl" name="editPasteUrl" placeholder="e.g., https://pastebin.com/xyz123" required>
                    </div>
                    <div class="form-group">
                        <label>Source Site</label>
                        <input type="text" id="editPasteSourceSite" placeholder="e.g., Pastebin, Pastie, Ghostbin">
                    </div>
                    <div class="form-group">
                        <label>Content Summary</label>
                        <textarea id="editPasteContentSummary" rows="3" placeholder="Brief summary of leaked data or text"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Keywords/Indicators</label>
                        <input type="text" id="editPasteKeywords" placeholder="e.g., email list, database dump, exploit code">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editPasteDescription" rows="3" placeholder="Detailed description of the paste's content and its relevance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editPasteNotes" rows="3" placeholder="Any specific notes or observations about this paste."></textarea>
                    </div>
                </div>
    
                <div id="editDocumentFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Document Title/Name</label>
                        <input type="text" id="editDocumentTitle" name="editDocumentTitle" placeholder="e.g., Project Proposal, Leaked Memo" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>File Type</label>
                        <input type="text" id="editDocumentFileType" placeholder="e.g., PDF, DOCX, XLSX, TXT">
                    </div>
                    <div class="form-group">
                        <label>File Hash (MD5/SHA256)</label>
                        <input type="text" id="editDocumentHash" placeholder="e.g., d41d8cd98f00b204e9800998ecf8427e">
                    </div>
                    <div class="form-group">
                        <label>Content Summary</label>
                        <textarea id="editDocumentContentSummary" rows="4" placeholder="Brief summary of document content, key findings"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source/Origin</label>
                        <input type="text" id="editDocumentSource" placeholder="e.g., Email attachment, Public server, Data breach">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editDocumentDescription" rows="3" placeholder="Detailed description of the document's content and context."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editDocumentNotes" rows="3" placeholder="Any specific notes or observations about this document."></textarea>
                    </div>
                </div>
    
                <div id="editNetworkFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Analysis Subject</label>
                        <input type="text" id="editNetworkSubject" name="editNetworkSubject" placeholder="e.g., 'Target Network Scan', 'Suspect's IP Traffic'" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Type of Analysis</label>
                        <select id="editNetworkType">
                            <option value="scan">Port Scan</option>
                            <option value="traffic">Network Traffic Analysis</option>
                            <option value="dns">DNS Analysis</option>
                            <option value="whois">WHOIS Lookup</option>
                            <option value="fingerprint">Device Fingerprinting</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Key Findings</label>
                        <textarea id="editNetworkFindings" rows="4" placeholder="Open ports, suspicious traffic, identified services, vulnerabilities"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Associated IPs/Domains</label>
                        <textarea id="editNetworkAssociated" rows="3" placeholder="Comma-separated list of IPs, domains, or URLs"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tools Used</label>
                        <input type="text" id="editNetworkTools" placeholder="e.g., Nmap, Wireshark, Shodan">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editNetworkDescription" rows="3" placeholder="Overall description of the network analysis conducted."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editNetworkNotes" rows="3" placeholder="Any specific notes or observations about this network analysis."></textarea>
                    </div>
                </div>
    
                <div id="editMetadataEntryFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Metadata Title/Context</label>
                        <input type="text" id="editMetadataTitle" placeholder="e.g., EXIF Data from Image, PDF Creation Info" required>
                    </div>
                    <p style="color: var(--text-muted); margin-bottom: 15px;">Use the 'Custom Metadata' section below to add key-value pairs for this entry.</p>
                    <div class="form-group">
                        <label>Metadata Description</label>
                        <textarea id="editMetadataDescription" rows="3" placeholder="A general description of the metadata collected or its context."></textarea>
                    </div>
                    <div class="form-group">
                        <label>File/Source</label>
                        <input type="text" id="editMetadataFileSource" placeholder="e.g., image.jpg, document.pdf, website header">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editMetadataNotes" rows="3" placeholder="Any specific notes or observations about this metadata."></textarea>
                    </div>
                </div>
    
                <div id="editArchiveFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Original URL</label>
                        <input type="url" id="editArchiveOriginalUrl" name="editArchiveOriginalUrl" placeholder="e.g., https://example.com/old-page" required>
                    </div>
                    <div class="form-group">
                        <label>Archived URL/Link</label>
                        <input type="url" id="editArchiveUrl" name="editArchiveUrl" placeholder="e.g., https://web.archive.org/web/..." required>
                    </div>
                    <div class="form-group">
                        <label>Archiving Service</label>
                        <input type="text" id="editArchiveService" placeholder="e.g., Wayback Machine, Archive.is, Google Cache">
                    </div>
                    <div class="form-group">
                        <label>Timestamp</label>
                        <input type="datetime-local" id="editArchiveTimestamp">
                    </div>
                    <div class="form-group">
                        <label>Content Summary</label>
                        <textarea id="editArchiveContentSummary" rows="4" placeholder="Brief summary of the archived content"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editArchiveDescription" rows="3" placeholder="Context or relevance of this archived page/content."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editArchiveNotes" rows="3" placeholder="Any specific notes or observations about this archived content."></textarea>
                    </div>
                </div>
    
                <div id="editMessagingFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Messaging App</label>
                        <select id="editMessagingApp" required>
                            <option value="whatsapp">WhatsApp</option>
                            <option value="telegram">Telegram</textareareadonly>
                            <option value="signal">Signal</option>
                            <option value="discord">Discord</option>
                            <option value="irc">IRC</option>
                            <option value="matrix">Matrix</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Username/ID</label>
                        <input type="text" id="editMessagingUsername" name="editMessagingUsername" placeholder="e.g., @userhandle, +1234567890" required>
                    </div>
                    <div class="form-group">
                        <label>Channel/Group/Chat ID</label>
                        <input type="text" id="editMessagingChatId" placeholder="e.g., Group Name, Channel ID">
                    </div>
                    <div class="form-group">
                        <label>Relevant Content</label>
                        <textarea id="editMessagingContent" rows="4" placeholder="Summary of conversations, key messages, shared files"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editMessagingDescription" rows="3" placeholder="Context or relevance of this messaging app entry."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editMessagingNotes" rows="3" placeholder="Any specific notes or observations about this messaging app entry."></textarea>
                    </div>
                </div>
    
                <div id="editFacialFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Subject/Person Identified</label>
                        <input type="text" id="editFacialSubject" name="editFacialSubject" placeholder="e.g., John Doe, Suspect 1" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Source Image/Video Description</label>
                        <textarea id="editFacialSourceDescription" rows="3" placeholder="Where was the image/video found?"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Identified Profiles/Platforms</label>
                        <textarea id="editFacialIdentifiedProfiles" rows="3" placeholder="e.g., Facebook Profile URL, Instagram Username"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Confidence Score</label>
                        <input type="text" id="editFacialConfidence" placeholder="e.g., High, 85%">
                    </div>
                    <div class="form-group">
                        <label>Tools Used</label>
                        <input type="text" id="editFacialToolsUsed" placeholder="e.g., PimEyes, Google Images, Facial Recognition Software">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editFacialDescription" rows="3" placeholder="Overall description of the facial recognition finding."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editFacialNotes" rows="3" placeholder="Any specific notes or observations about this facial recognition entry."></textarea>
                    </div>
                </div>
    
                <div id="editPersonaFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Persona Name/Alias</label>
                        <input type="text" id="editPersonaName" name="editPersonaName" placeholder="e.g., 'Online Gamer X', 'Business Account Y'" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Real Name (if known)</label>
                        <input type="text" id="editPersonaRealName" placeholder="e.g., John Doe" maxlength="100">
                    </div>
                    <div class="form-group">
                        <label>Associated Usernames/Emails</label>
                        <textarea id="editPersonaAssociatedAccounts" rows="3" placeholder="List all linked usernames, emails, phone numbers"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Bio/Description</label>
                        <textarea id="editPersonaBio" rows="4" placeholder="Profile bio or description of the persona."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Platforms Used</label>
                        <input type="text" id="editPersonaPlatforms" placeholder="e.g., Twitter, Discord, Dark Web Forums">
                    </div>
                    <div class="form-group">
                        <label>Origin/Purpose</label>
                        <input type="text" id="editPersonaOrigin" placeholder="e.g., Scammer, Investigator, Activist">
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editPersonaNotes" rows="3" placeholder="Any specific notes or observations about this persona."></textarea>
                    </div>
                </div>
    
                <div id="editHoneypotFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Honeypot Type</label>
                        <select id="editHoneypotType" required>
                            <option value="low-interaction">Low Interaction</option>
                            <option value="high-interaction">High Interaction</option>
                            <option value="data">Data Honeypot</option>
                            <option value="network">Network Honeypot</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Deployment Location/IP</label>
                        <input type="text" id="editHoneypotLocation" placeholder="e.g., Public Cloud, 192.168.1.1">
                    </div>
                    <div class="form-group">
                        <label>Purpose</label>
                        <input type="text" id="editHoneypotPurpose" placeholder="e.g., Malware Analysis, Threat Actor Tracking">
                    </div>
                    <div class="form-group">
                        <label>Captured Data Summary</label>
                        <textarea id="editHoneypotDataSummary" rows="4" placeholder="Summary of captured attacks, malware, IPs"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Alerts/Indicators</label>
                        <textarea id="editHoneypotAlerts" rows="3" placeholder="Key indicators or alerts generated"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editHoneypotDescription" rows="3" placeholder="Detailed description of the honeypot setup and findings."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editHoneypotNotes" rows="3" placeholder="Any specific notes or observations about this honeypot."></textarea>
                    </div>
                </div>
    
                <div id="editExploitFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Exploit Name/ID</label>
                        <input type="text" id="editExploitName" name="editExploitName" placeholder="e.g., EternalBlue, CVE-2023-XXXX" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Target Vulnerability</label>
                        <input type="text" id="editExploitTargetVuln" placeholder="e.g., MS17-010, Adobe Flash Zero-Day">
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="editExploitType">
                            <option value="rce">Remote Code Execution</option>
                            <option value="privesc">Privilege Escalation</option>
                            <option value="dos">Denial of Service</option>
                            <option value="zero-day">Zero-Day</option>
                            <option value="poc">PoC</option>
                            <option value="weaponized">Weaponized</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Market/Source</label>
                        <input type="text" id="editExploitMarketSource" placeholder="e.g., Exploit-DB, Underground Market, Private Sale">
                    </div>
                    <div class="form-group">
                        <label>Price/Value</label>
                        <input type="text" id="editExploitPrice" placeholder="e.g., $10,000, 2 BTC">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editExploitDescription" rows="3" placeholder="Technical description of the exploit and its capabilities."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editExploitNotes" rows="3" placeholder="Any specific notes or observations about this exploit."></textarea>
                    </div>
                </div>
    
                <div id="editPublicRecordFields" class="entry-fields" style="display: none;">
                    <div class="form-group">
                        <label>Record Type</label>
                        <select id="editPublicRecordType" required>
                            <option value="court">Court Record</option>
                            <option value="property">Property Record</option>
                            <option value="business">Business Registration</option>
                            <option value="voter">Voter Registration</option>
                            <option value="license">License/Permit</option>
                            <option value="tax">Tax Record</option>
                            <option value="marriage">Marriage/Divorce</option>
                            <option value="birth_death">Birth/Death Certificate</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Subject Name</label>
                        <input type="text" id="editPublicRecordSubjectName" name="editPublicRecordSubjectName" placeholder="e.g., John Doe" maxlength="100" required>
                    </div>
                    <div class="form-group">
                        <label>Case/Reference ID</label>
                        <input type="text" id="editPublicRecordRefId" placeholder="e.g., Case #12345, Doc-XYZ">
                    </div>
                    <div class="form-group">
                        <label>Jurisdiction/Location</label>
                        <input type="text" id="editPublicRecordJurisdiction" placeholder="e.g., New York, NY; Federal Court">
                    </div>
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="editPublicRecordDate">
                    </div>
                    <div class="form-group">
                        <label>Summary/Key Details</label>
                        <textarea id="editPublicRecordSummary" rows="4" placeholder="Summary of record content and relevance"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Source URL/Location</label>
                        <input type="url" id="editPublicRecordSourceUrl" placeholder="e.g., official website link">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="editPublicRecordDescription" rows="3" placeholder="General description of the public record and its significance."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Investigation Notes</label>
                        <textarea id="editPublicRecordNotes" rows="3" placeholder="Any specific notes or observations about this public record."></textarea>
                    </div>
                </div>
    
                <div class="form-group" id="editEntrySourceGroup">
                    <label>Source (Where was this info collected?)</label>
                    <input type="text" id="editEntrySource" name="editEntrySource" placeholder="e.g., public record, social media, dark web forum">
                </div>
    
                <div id="editCustomMetadataGroup">
                    <label>Custom Metadata</label>
                    <div id="editCustomMetadataEntries">
                        </div>
                    <button type="button" class="btn btn-secondary btn-sm add-metadata-btn" id="editAddMetadataBtn">
                        <i class="fas fa-plus"></i> Add Metadata Field
                    </button>
                </div>
    
                <div class="custom-tab-assignment" id="assignCustomTabs">
                    <h4>Assign to Custom Vault Tab(s)</h4>
                    <div class="custom-tab-checkboxes" id="assignCustomTabsCheckboxes">
                    </div>
                </div>
    
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelEditEntry">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="createSubTabModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--primary);">
                <i class="fas fa-plus-circle"></i>
                Create New Custom Vault
            </h3>
            <form id="createSubTabForm">
                <div class="form-group">
                    <label>Vault Name</label>
                    <input type="text" id="newSubTabName" required>
                </div>
                <div class="form-group">
                    <label>Icon (Font Awesome class, e.g., 'fas fa-globe')</label>
                    <input type="text" id="newSubTabIcon" placeholder="fas fa-globe">
                    <div class="icon-picker-grid" id="newSubTabIconPicker"></div>
                </div>
                <div class="form-group">
                    <label>Color</label>
                    <input type="hidden" id="newSubTabColor">
                    <div class="color-picker-grid" id="newSubTabColorPicker"></div>
                </div>
                <div class="form-group">
                    <label>Add Tools to this Vault</label>
                    <div id="newCustomVaultToolSelection" class="custom-tab-checkboxes" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; border-radius: 8px; background: var(--bg-secondary);">
                        </div>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelCreateSubTab">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Vault</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="editSubTabModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--primary);">
                <i class="fas fa-edit"></i>
                Edit Custom Vault
            </h3>
            <form id="editSubTabForm">
                <input type="hidden" id="editSubTabId">
                <div class="form-group">
                    <label>Vault Name</label>
                    <input type="text" id="editedSubTabName" required>
                </div>
                <div class="form-group">
                    <label>Icon (Font Awesome class, e.g., 'fas fa-globe')</label>
                    <input type="text" id="editedSubTabIcon" placeholder="fas fa-globe">
                     <div class="icon-picker-grid" id="editedSubTabIconPicker"></div>
                </div>
                 <div class="form-group">
                    <label>Color</label>
                    <input type="hidden" id="editedSubTabColor">
                    <div class="color-picker-grid" id="editedSubTabColorPicker"></div>
                </div>
                <div class="form-group">
                    <label>Tools in this Vault</label>
                    <div id="editCustomVaultToolSelection" class="custom-tab-checkboxes" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; border-radius: 8px; background: var(--bg-secondary);">
                        </div>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelEditSubTab">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="shareOptionsModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--primary);">
                <i class="fas fa-share-alt"></i> Share Intelligence
            </h3>
            <form id="shareForm">
                <div class="form-group">
                    <label for="shareScopeSelect">What would you like to share?</label>
                    <select id="shareScopeSelect">
                        <option value="currentTab">Current Tab (Read-Only View)</option>
                        <option value="allVault">All Intelligence Vault (Read-Only View)</option>
                        <option value="allData">All Data (Read-Only View)</option>
                        <option value="specificCustomTabPlaceholder">Specific Custom Vault...</option>
                        </select>
                </div>
    
                <div id="specificCustomTabSelector" class="form-group" style="display:none;">
                    <label for="selectCustomTabForSharing">Select a Custom Vault to share:</label>
                    <select id="selectCustomTabForSharing">
                        </select>
                </div>
    
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelShareOptions">Cancel</button>
                    <button type="submit" class="btn btn-primary">Generate Link</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="caseStudyDetailModal">
        <div class="modal-content">
            <button type="button" class="close-modal-btn" onclick="hideModal('caseStudyDetailModal')">&times;</button>
            
            <div class="case-study-detail-header">
                <h3 class="detail-title" id="detailCaseStudyTitle"></h3>
                <div class="detail-meta">
                    <span><i class="fas fa-tags"></i> Type: <span id="detailCaseStudyType"></span></span>
                    <span><i class="fas fa-calendar-alt"></i> Date: <span id="detailCaseStudyDate"></span></span>
                    <span><i class="fas fa-user-secret"></i> Actor: <span id="detailCaseStudyActor"></span></span>
                    <span><i class="fas fa-level-up-alt"></i> Difficulty: <span id="detailCaseStudyDifficulty"></span></span>
                </div>
            </div>
            <div class="detail-content">
                <h3>Overview</h3>
                <p id="detailCaseStudySummary"></p>

                <h3>Attack Chain</h3>
                <div id="detailCaseStudyAttackChain"></div>

                <h3>OSINT Techniques Used</h3>
                <ul id="detailCaseStudyTechniques"></ul>

                <h3>Key Tools Involved</h3>
                <ul id="detailCaseStudyTools"></ul>

                <h3>Lessons Learned</h3>
                <div id="detailCaseStudyLessons"></div>
            </div>
            <div class="detail-tags" id="detailCaseStudyTags"></div>
        </div>
    </div>

    <div class="modal" id="addEditCaseStudyModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-plus-circle"></i> <span id="addEditCaseStudyModalTitle">Add New Case Study</span></h3>
            <form id="addEditCaseStudyForm">
                <input type="hidden" id="caseStudyId">
                <div class="form-group">
                    <label for="caseStudyTitle">Title</label>
                    <input type="text" id="caseStudyTitle" required placeholder="e.g., SolarWinds Supply Chain Attack">
                </div>
                <div class="form-group">
                    <label for="caseStudyIncidentType">Incident Type</label>
                    <select id="caseStudyIncidentType" required>
                        <option value="">Select Type</option>
                        <option value="ransomware">Ransomware</option>
                        <option value="phishing">Phishing</option>
                        <option value="insider-threat">Insider Threat</option>
                        <option value="data-breach">Data Breach</option>
                        <option value="apt">APT Activity</option>
                        <option value="ddos">DDoS Attack</option>
                        <option value="malware">Malware Analysis</option>
                        <option value="fraud">Fraud</option>
                        <option value="other">Other</option>
                        <option value="custom">Custom Type</option>
                    </select>
                    <input type="text" id="newCaseStudyTypeInput" placeholder="Or enter new type" style="margin-top: 10px; display: none;">
                </div>
                <div class="form-group">
                    <label for="caseStudyDateRange">Date (e.g., 2023-01-01 to 2023-01-31)</label>
                    <input type="text" id="caseStudyDateRange" placeholder="e.g., 2023-01-01 to 2023-01-31" required>
                </div>
                <div class="form-group">
                    <label for="caseStudyActor">Threat Actor (Optional)</label>
                    <input type="text" id="caseStudyActor" placeholder="e.g., APT28, UNC2452">
                </div>
                <div class="form-group">
                    <label for="caseStudyDifficulty">Difficulty</label>
                    <select id="caseStudyDifficulty" required>
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advanced</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="caseStudySummary">Summary</label>
                    <textarea id="caseStudySummary" rows="3" placeholder="Brief overview of the case study."></textarea>
                </div>
                <div class="form-group">
                    <label for="caseStudyAttackChain">Attack Chain (Rich Text)</label>
                    <div class="formatting-toolbar">
                        <button type="button" class="formatting-btn" data-command="bold" title="Bold">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="italic" title="Italic">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="underline" title="Underline">
                            <i class="fas fa-underline"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="insertUnorderedList" title="Bullet List">
                            <i class="fas fa-list-ul"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="insertOrderedList" title="Numbered List">
                            <i class="fas fa-list-ol"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="createLink" title="Insert Link">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                    <div id="caseStudyAttackChain" class="note-content-editor" contenteditable="true" style="min-height: 150px;"></div>
                </div>
                <div class="form-group">
                    <label for="caseStudyOsintTechniques">OSINT Techniques Used (comma separated)</label>
                    <input type="text" id="caseStudyOsintTechniques" placeholder="e.g., DNS Recon, Social Media Analysis">
                </div>
                <div class="form-group">
                    <label for="caseStudyToolsUsed">Key Tools Involved (comma separated)</label>
                    <input type="text" id="caseStudyToolsUsed" placeholder="e.g., Wireshark, Maltego, VirusTotal">
                </div>
                <div class="form-group">
                    <label for="caseStudyLessons">Lessons Learned (Rich Text)</label>
                     <div class="formatting-toolbar">
                        <button type="button" class="formatting-btn" data-command="bold" title="Bold">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="italic" title="Italic">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="underline" title="Underline">
                            <i class="fas fa-underline"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="insertUnorderedList" title="Bullet List">
                            <i class="fas fa-list-ul"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="insertOrderedList" title="Numbered List">
                            <i class="fas fa-list-ol"></i>
                        </button>
                        <button type="button" class="formatting-btn" data-command="createLink" title="Insert Link">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                    <div id="caseStudyLessons" class="note-content-editor" contenteditable="true" style="min-height: 150px;"></div>
                </div>
                <div class="form-group">
                    <label for="caseStudyTags">Tags (comma separated)</label>
                    <input type="text" id="caseStudyTags" placeholder="e.g., cybercrime, forensics, darkweb">
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelCaseStudyAddEdit">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="saveCaseStudyBtn">Save Case Study</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="addEditScriptModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-plus-circle"></i> <span id="addEditScriptModalTitle">Add New Script</span></h3>
            <form id="addEditScriptForm">
                <input type="hidden" id="scriptId">
                <div class="form-group">
                    <label for="scriptName">Script Name</label>
                    <input type="text" id="scriptName" required placeholder="e.g., Sysmon Event Parser, Firewall Log Analyzer">
                </div>
                <div class="form-group">
                    <label for="scriptDescription">Description</label>
                    <textarea id="scriptDescription" rows="3" placeholder="Brief explanation of what the script does and its purpose."></textarea>
                </div>
                <div class="form-group">
                    <label for="scriptLanguage">Language</label>
                    <select id="scriptLanguage" required>
                        <option value="">Select Language</option>
                        <option value="powershell">PowerShell</option>
                        <option value="python">Python</option>
                        <option value="bash">Bash/Shell</option>
                        <option value="cmd">CMD Batch</option>
                        <option value="c#">C#</option>
                        <option value="go">Go</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="scriptCode">Script Code (or Command)</label>
                    <textarea id="scriptCode" rows="10" placeholder="Paste your script code here, or a single command/snippet." style="font-family: 'JetBrains Mono', monospace;"></textarea>
                </div>
                <div class="form-group">
                    <label for="scriptTags">Tags (comma separated)</label>
                    <input type="text" id="scriptTags" placeholder="e.g., endpoint, network, detection, forensics">
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" id="cancelScriptAddEdit">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="saveScriptBtn">Save Script</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="scriptCodeDisplayModal">
        <div class="modal-content">
            <button type="button" class="close-modal-btn" onclick="hideModal('scriptCodeDisplayModal')">&times;</button>
            <h3 style="margin-bottom: 20px; color: var(--primary);"><i class="fas fa-code"></i> Script Code: <span id="displayScriptName"></span></h3>
            <pre id="displayScriptCode"></pre>
            <div style="text-align: right;">
                <button class="copy-code-btn" id="copyScriptCodeBtn">
                    <i class="fas fa-copy"></i> Copy Code
                </button>
            </div>
        </div>
    </div>

    <div class="tab-content" id="threat-huntingTab">
        <div class="content-header">
            <h2 class="content-title">Cyber Threat Hunting Toolkit</h2>
            <div class="controls">
                <button class="btn btn-primary" id="addScriptBtn">
                    <i class="fas fa-plus-circle"></i>
                    Add New Script
                </button>
                <button class="btn btn-secondary" id="scriptViewToggle" title="Switch to List View">
                    <i class="fas fa-list"></i>
                    List View
                </button>
            </div>
        </div>
        <div class="sub-nav-tabs">
            <button class="sub-nav-tab th-subtab active" data-th-subtab="script-library">
                <i class="fas fa-code"></i> Script Library
            </button>
            <button class="sub-nav-tab th-subtab" data-th-subtab="dashboards">
                <i class="fas fa-chart-bar"></i> Dashboards
            </button>
            <button class="sub-nav-tab th-subtab" data-th-subtab="playbooks">
                <i class="fas fa-book-open"></i> Playbooks
            </button>
        </div>

        <div class="th-subtab-content" id="script-library-content" style="display: block; margin-top: 20px;">
            <div class="tools-grid" id="scriptLibraryGrid">
                </div>
            <div class="empty-state" id="emptyScriptLibraryState" style="display: none;">
                <i class="fas fa-code"></i>
                <h3>No Scripts Found</h3>
                <p>Add your first threat hunting script to get started!</p>
                <button class="btn btn-primary" id="addScriptEmptyStateBtn">
                    <i class="fas fa-plus"></i> Add First Script
                </button>
            </div>
        </div>

        <div class="th-subtab-content" id="dashboards-content" style="display: none; margin-top: 20px;">
            <div class="empty-state">
                <i class="fas fa-chart-line"></i>
                <h3>Dashboards (Coming Soon)</h3>
                <p>This section will feature interactive dashboards for threat hunting.</p>
            </div>
        </div>

        <div class="th-subtab-content" id="playbooks-content" style="display: none; margin-top: 20px;">
            <div class="empty-state">
                <i class="fas fa-book-open"></i>
                <h3>Hunting Playbooks (Coming Soon)</h3>
                <p>A collection of step-by-step guides for various threat hunting scenarios.</p>
            </div>
        </div>
    </div>

    <script src="./java/core.js"></script>
    <script src="./java/modals-and-forms.js"></script>
    <script src="./java/entry-rendering-and-filters.js"></script>
    <script src="./java/custom-vault.js"></script>
    <script src="./java/dashboard.js"></script>
    <script src="./java/handbook-and-notes.js"></script>
    <script src="./java/dork-assistant.js"></script>
    <script src="./java/timeline.js"></script>
    <script src="./java/case-studies.js"></script>
    <script src="./java/threat-intel-and-hunting.js"></script>
    <script src="./java/event-bindings.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // This is the *only* custom JavaScript left in the HTML.
        // It ensures initApp is called once all external scripts are loaded.
        document.addEventListener('DOMContentLoaded', initApp);

        // Auto-detect system theme preference (can be kept here or moved to core.js initTheme)
        // Keeping it here for quick startup visual consistency before initApp fully runs.
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
            // Assuming #themeToggle has a relevant icon for this.
            const themeToggleBtn = document.getElementById('themeToggle');
            if (themeToggleBtn) {
                themeToggleBtn.innerHTML = '<i class="fas fa-moon"></i>';
            }
        }
    </script>

</body>
</html>
