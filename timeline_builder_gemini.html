<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracelink - Advanced Threat Investigation Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* General Styles & Reset */
        :root {
            --tracelink-color-dark-bg-start: #0a111f;
            --tracelink-color-dark-bg-end: #1a2233;
            --tracelink-color-text-light: #e2e8f0;
            --tracelink-color-text-dark: #1e293b;
            --tracelink-color-subtle-text: #64748b;
            --tracelink-color-border-light: rgba(255, 255, 255, 0.15);
            --tracelink-color-border-dark: rgba(71, 85, 105, 0.3);
            --tracelink-color-white-transparent: rgba(255, 255, 255, 0.95);
            --tracelink-color-white-more-transparent: rgba(255, 255, 255, 0.85);
            --tracelink-color-black-transparent: rgba(0, 0, 0, 0.25);
            --tracelink-color-black-less-transparent: rgba(0, 0, 0, 0.1);
            --tracelink-color-black-faint-transparent: rgba(0, 0, 0, 0.06);

            /* Primary Action Color */
            --tracelink-color-primary-blue: #3b82f6;
            --tracelink-color-primary-dark-blue: #1d4ed8;

            /* Severity Colors */
            --tracelink-severity-critical: #dc2626;
            --tracelink-severity-high: #ea580c;
            --tracelink-severity-medium: #d97706;
            --tracelink-severity-low: #059669;
            --tracelink-severity-info: #0284c7;

            /* Severity Backgrounds (faint) */
            --tracelink-bg-critical-faint: rgba(220, 38, 38, 0.05);
            --tracelink-bg-high-faint: rgba(234, 88, 12, 0.05);
            --tracelink-bg-medium-faint: rgba(217, 119, 6, 0.05);
            --tracelink-bg-low-faint: rgba(5, 150, 105, 0.05);
            --tracelink-bg-info-faint: rgba(2, 132, 199, 0.05);
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--tracelink-color-dark-bg-start) 0%, var(--tracelink-color-dark-bg-end) 100%);
            min-height: 100vh;
            color: var(--tracelink-color-text-dark); /* Default text color for content areas */
            line-height: 1.6;
        }

        /* Container for main content */
        .tracelink-container {
            max-width: 1280px;
            margin-left: auto;
            margin-right: auto;
            padding-left: 1.5rem;
            padding-right: 1.5rem;
        }

        /* Spacing utilities (simple replacements for Tailwind) */
        .tracelink-py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .tracelink-py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .tracelink-px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .tracelink-mb-6 { margin-bottom: 1.5rem; }
        .tracelink-mb-8 { margin-bottom: 2rem; }
        .tracelink-mt-1 { margin-top: 0.25rem; }
        .tracelink-mt-6 { margin-top: 1.5rem; }
        .tracelink-pt-6 { padding-top: 1.5rem; }
        .tracelink-space-x-2 > *:not(:first-child) { margin-left: 0.5rem; }
        .tracelink-space-x-3 > *:not(:first-child) { margin-left: 0.75rem; }
        .tracelink-space-x-4 > *:not(:first-child) { margin-left: 1rem; }
        .tracelink-space-y-3 > *:not(:first-child) { margin-top: 0.75rem; }
        .tracelink-space-y-6 > *:not(:first-child) { margin-top: 1.5rem; }
        .tracelink-gap-4 { gap: 1rem; }
        .tracelink-gap-6 { gap: 1.5rem; }
        .tracelink-p-6 { padding: 1.5rem; }
        .tracelink-p-8 { padding: 2rem; }
        .tracelink-pb-4 { padding-bottom: 1rem; }

        /* Flexbox and Grid Utilities (simple replacements for Tailwind) */
        .tracelink-flex { display: flex; }
        .tracelink-items-center { align-items: center; }
        .tracelink-items-start { align-items: flex-start; }
        .tracelink-justify-between { justify-content: space-between; }
        .tracelink-justify-center { justify-content: center; }
        .tracelink-justify-end { justify-content: flex-end; }
        .tracelink-flex-col { flex-direction: column; }
        .tracelink-flex-wrap { flex-wrap: wrap; }
        .tracelink-grid { display: grid; }
        .tracelink-grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .tracelink-lg\:grid-cols-2 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }
        .tracelink-lg\:grid-cols-3 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }
        .tracelink-lg\:grid-cols-4 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }
        @media (min-width: 1024px) { /* Equivalent to lg: breakpoint */
            .tracelink-lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .tracelink-lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .tracelink-lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        }
        .tracelink-text-center { text-align: center; }
        .tracelink-text-right { text-align: right; }
        .tracelink-block { display: block; }

        /* Typography */
        .tracelink-text-xs { font-size: 0.75rem; }
        .tracelink-text-sm { font-size: 0.875rem; }
        .tracelink-text-base { font-size: 1rem; }
        .tracelink-text-lg { font-size: 1.125rem; }
        .tracelink-text-xl { font-size: 1.25rem; }
        .tracelink-text-2xl { font-size: 1.5rem; }
        .tracelink-font-light { font-weight: 300; }
        .tracelink-font-normal { font-weight: 400; }
        .tracelink-font-medium { font-weight: 500; }
        .tracelink-font-semibold { font-weight: 600; }
        .tracelink-font-bold { font-weight: 700; }
        .tracelink-tracking-tight { letter-spacing: -0.025em; }
        .tracelink-tracking-wide { letter-spacing: 0.025em; }
        .tracelink-uppercase { text-transform: uppercase; }
        .tracelink-font-mono { font-family: monospace; }

        /* Colors (mapped from Tailwind classes) */
        .tracelink-text-white { color: #fff; }
        .tracelink-text-slate-50 { color: #f8fafc; }
        .tracelink-text-slate-100 { color: #f1f5f9; }
        .tracelink-text-slate-200 { color: #e2e8f0; }
        .tracelink-text-slate-300 { color: #cbd5e1; }
        .tracelink-text-slate-400 { color: #94a3b8; }
        .tracelink-text-slate-500 { color: #64748b; }
        .tracelink-text-slate-600 { color: #475569; }
        .tracelink-text-slate-700 { color: #334155; }
        .tracelink-text-slate-800 { color: #1e293b; }
        .tracelink-text-slate-900 { color: #0f172a; }

        .tracelink-bg-white { background-color: #fff; }
        .tracelink-bg-slate-50 { background-color: #f8fafc; }
        .tracelink-bg-slate-100 { background-color: #f1f5f9; }
        .tracelink-bg-slate-200 { background-color: #e2e8f0; }
        .tracelink-bg-slate-800 { background-color: #1e293b; }
        .tracelink-bg-slate-900 { background-color: #0f172a; }

        .tracelink-bg-emerald-500 { background-color: #10b981; }
        .tracelink-bg-teal-600 { background-color: #0d9488; }
        .tracelink-bg-blue-500 { background-color: #3b82f6; }
        .tracelink-bg-purple-600 { background-color: #9333ea; }
        .tracelink-bg-green-500 { background-color: #22c55e; }
        .tracelink-bg-red-500 { background-color: #ef4444; }
        .tracelink-bg-orange-500 { background-color: #f97316; }
        .tracelink-bg-yellow-500 { background-color: #eab308; }

        .tracelink-text-red-600 { color: #dc2626; }
        .tracelink-text-blue-600 { color: #2563eb; }
        .tracelink-text-purple-600 { color: #9333ea; }
        .tracelink-text-green-600 { color: #059669; }
        .tracelink-text-emerald-600 { color: #059669; } /* Re-using green for emerald */
        .tracelink-text-blue-800 { color: #1e40af; }
        .tracelink-text-purple-800 { color: #6b21a8; }


        .tracelink-border-t { border-top-width: 1px; }
        .tracelink-border-b { border-bottom-width: 1px; }
        .tracelink-border-slate-200 { border-color: #e2e8f0; }
        .tracelink-border-slate-300 { border-color: #cbd5e1; }

        /* Rounded corners */
        .tracelink-rounded-full { border-radius: 9999px; }
        .tracelink-rounded-lg { border-radius: 0.5rem; }
        .tracelink-rounded-xl { border-radius: 0.75rem; }
        .tracelink-rounded-2xl { border-radius: 1rem; }
        .tracelink-rounded-t-2xl { border-top-left-radius: 1rem; border-top-right-radius: 1rem; }

        /* Sizing */
        .tracelink-w-full { width: 100%; }
        .tracelink-w-2 { width: 0.5rem; }
        .tracelink-w-3 { width: 0.75rem; }
        .tracelink-w-4 { width: 1rem; }
        .tracelink-w-5 { width: 1.25rem; }
        .tracelink-w-6 { width: 1.5rem; }
        .tracelink-w-8 { width: 2rem; }
        .tracelink-w-10 { width: 2.5rem; }
        .tracelink-w-12 { width: 3rem; }
        .tracelink-w-24 { width: 6rem; }
        .tracelink-h-2 { height: 0.5rem; }
        .tracelink-h-3 { height: 0.75rem; }
        .tracelink-h-4 { height: 1rem; }
        .tracelink-h-5 { height: 1.25rem; }
        .tracelink-h-6 { height: 1.5rem; }
        .tracelink-h-8 { height: 2rem; }
        .tracelink-h-10 { height: 2.5rem; }
        .tracelink-h-12 { height: 3rem; }
        .tracelink-h-24 { height: 6rem; }
        .tracelink-min-h-screen { min-height: 100vh; }
        .tracelink-max-w-md { max-width: 28rem; }
        .tracelink-max-w-4xl { max-width: 56rem; }
        .tracelink-max-h-\[90vh\] { max-height: 90vh; }

        /* Positioning */
        .tracelink-relative { position: relative; }
        .tracelink-absolute { position: absolute; }
        .tracelink-fixed { position: fixed; }
        .tracelink-sticky { position: sticky; }
        .tracelink-top-0 { top: 0; }
        .tracelink-right-4 { right: 1rem; }
        .tracelink-inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
        .tracelink-z-40 { z-index: 40; }
        .tracelink-z-50 { z-index: 50; }
        .tracelink-z-1000 { z-index: 1000; } /* For tracelink-notifications */

        /* Display */
        .tracelink-hidden { display: none; }
        .tracelink-overflow-y-auto { overflow-y: auto; }
        .tracelink-resize-none { resize: none; }

        /* Gradients (re-mapped to custom CSS variables for consistency) */
        .tracelink-bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tracelink-color-primary-blue), var(--tracelink-purple-main)); }
        .tracelink-bg-gradient-to-br.tracelink-emerald-teal { background-image: linear-gradient(to bottom right, #10b981, #0d9488); }
        .tracelink-bg-gradient-to-r { background-image: linear-gradient(to right, var(--tracelink-color-dark-bg-start), var(--tracelink-slate-900)); }


        /* Professional Header */
        .tracelink-header-gradient {
            background: linear-gradient(135deg, var(--tracelink-color-dark-bg-start) 0%, #1e293b 50%, #334155 100%);
            border-bottom: 1px solid var(--tracelink-color-border-dark);
        }

        /* Professional glass morphism effects */
        .tracelink-glass-card {
            background: var(--tracelink-color-white-transparent);
            backdrop-filter: blur(20px);
            border: 1px solid var(--tracelink-color-border-light);
            box-shadow: 0 25px 50px -12px var(--tracelink-color-black-transparent);
            border-radius: 1rem; /* Consistent border-radius for cards */
        }

        /* Professional timeline design */
        .tracelink-timeline-container {
            position: relative;
            max-height: 800px;
            overflow-y: auto;
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 1rem;
            border: 1px solid rgba(148, 163, 184, 0.2);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.02);
            padding-top: 1rem; /* Adjust padding for spine alignment */
        }

        .tracelink-timeline-spine {
            position: absolute;
            left: 3rem;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, 
                var(--tracelink-color-primary-blue) 0%, 
                var(--tracelink-color-primary-dark-blue) 25%, 
                #9333ea 50%, /* Adjusted for consistency */
                #db2777 75%, /* Adjusted for consistency */
                #dc2626 100%); /* Adjusted for consistency */
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
        }

        .tracelink-timeline-event {
            position: relative;
            margin-left: 5rem;
            margin-right: 2rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            border-radius: 0.75rem; /* Consistent border-radius for tracelink-events */
            background: var(--tracelink-color-white-transparent);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            box-shadow: 0 4px 6px -1px var(--tracelink-color-black-less-transparent), 0 2px 4px -1px var(--tracelink-color-black-faint-transparent);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 4px solid; /* For severity indicator */
        }

        .tracelink-timeline-event:hover {
            transform: translateX(8px) translateY(-2px);
            box-shadow: 0 20px 25px -5px var(--tracelink-color-black-less-transparent), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            background: #fff; /* Fully opaque on hover */
        }

        .tracelink-timeline-pulse {
            position: absolute;
            left: 2.25rem;
            top: 1.5rem;
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            background: white;
            border: 3px solid;
            z-index: 10;
            animation: tracelink-pulse 2s infinite;
        }

        @keyframes tracelink-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        /* Threat level colors and backgrounds */
        .tracelink-threat-critical { 
            border-left-color: var(--tracelink-severity-critical); 
            background: linear-gradient(135deg, var(--tracelink-bg-critical-faint) 0%, var(--tracelink-color-white-transparent) 100%);
        }
        .tracelink-threat-critical .tracelink-timeline-pulse { border-color: var(--tracelink-severity-critical); box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }

        .tracelink-threat-high { 
            border-left-color: var(--tracelink-severity-high); 
            background: linear-gradient(135deg, var(--tracelink-bg-high-faint) 0%, var(--tracelink-color-white-transparent) 100%);
        }
        .tracelink-threat-high .tracelink-timeline-pulse { border-color: var(--tracelink-severity-high); }

        .tracelink-threat-medium { 
            border-left-color: var(--tracelink-severity-medium); 
            background: linear-gradient(135deg, var(--tracelink-bg-medium-faint) 0%, var(--tracelink-color-white-transparent) 100%);
        }
        .tracelink-threat-medium .tracelink-timeline-pulse { border-color: var(--tracelink-severity-medium); }

        .tracelink-threat-low { 
            border-left-color: var(--tracelink-severity-low); 
            background: linear-gradient(135deg, var(--tracelink-bg-low-faint) 0%, var(--tracelink-color-white-transparent) 100%);
        }
        .tracelink-threat-low .tracelink-timeline-pulse { border-color: var(--tracelink-severity-low); }

        .tracelink-threat-info { 
            border-left-color: var(--tracelink-severity-info); 
            background: linear-gradient(135deg, var(--tracelink-bg-info-faint) 0%, var(--tracelink-color-white-transparent) 100%);
        }
        .tracelink-threat-info .tracelink-timeline-pulse { border-color: var(--tracelink-severity-info); }

        /* Professional badges */
        .tracelink-severity-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            white-space: nowrap; /* Prevent badge text from wrapping */
        }

        .tracelink-severity-critical-badge { background: #fef2f2; color: #991b1b; border: 1px solid #fca5a5; }
        .tracelink-severity-high-badge { background: #fff7ed; color: #9a3412; border: 1px solid #fed7aa; }
        .tracelink-severity-medium-badge { background: #fffbeb; color: #92400e; border: 1px solid #fde68a; }
        .tracelink-severity-low-badge { background: #f0fdf4; color: #166534; border: 1px solid #bbf7d0; }
        .tracelink-severity-info-badge { background: #eff6ff; color: #1e40af; border: 1px solid #bfdbfe; }

        /* Professional buttons */
        .tracelink-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem; /* tracelink-py-3 tracelink-px-6 */
            border-radius: 0.75rem; /* tracelink-rounded-xl */
            font-weight: 500; /* tracelink-font-medium */
            transition: all 0.2s ease;
            cursor: pointer;
            text-decoration: none; /* For button-like links */
            flex-grow: 1; /* Allow tracelink-buttons to grow to fill space */
            white-space: nowrap; /* Prevent button text from wrapping */
        }
        .tracelink-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 16px -4px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .tracelink-btn-primary {
            background: linear-gradient(135deg, var(--tracelink-color-primary-blue) 0%, var(--tracelink-color-primary-dark-blue) 100%);
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            color: #fff;
        }

        .tracelink-btn-success {
            background: linear-gradient(135deg, var(--tracelink-severity-low) 0%, #047857 100%);
            border: 1px solid rgba(5, 150, 105, 0.3);
            color: #fff;
        }

        .tracelink-btn-danger {
            background: linear-gradient(135deg, var(--tracelink-severity-critical) 0%, #b91c1c 100%);
            border: 1px solid rgba(220, 38, 38, 0.3);
            color: #fff;
            padding: 0.625rem 1rem; /* tracelink-py-2.5 tracelink-px-4 */
            border-radius: 0.5rem; /* tracelink-rounded-lg */
            font-size: 0.875rem; /* tracelink-text-sm */
        }

        .tracelink-btn-secondary {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: #fff;
        }

        .tracelink-btn-warning {
            background: linear-gradient(135deg, var(--tracelink-severity-medium) 0%, #b45309 100%);
            border: 1px solid rgba(217, 119, 6, 0.3);
            color: #fff;
        }

        .tracelink-btn-text-only {
            padding: 0.5rem 1rem; /* tracelink-py-2 tracelink-px-4 */
            border: 1px solid var(--tracelink-color-border-dark);
            color: var(--tracelink-color-subtle-text);
            background: #fff;
            border-radius: 0.5rem; /* tracelink-rounded-lg */
            font-weight: 500;
        }
        .tracelink-btn-text-only:hover {
            background: #f8fafc;
            box-shadow: none;
            transform: translateY(0);
        }

        /* Professional modal */
        .tracelink-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .tracelink-modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(8px);
        }

        .tracelink-modal-content {
            position: relative;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            border-radius: 1rem; /* tracelink-rounded-2xl */
            max-width: 56rem; /* tracelink-max-w-4xl */
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 51; /* Above backdrop */
        }
        .tracelink-modal.tracelink-hidden {
            display: none;
        }

        /* Professional form styling */
        .tracelink-form-label {
            display: block;
            font-size: 0.875rem; /* tracelink-text-sm */
            font-weight: 600; /* tracelink-font-semibold */
            color: #334155; /* tracelink-text-slate-700 */
            margin-bottom: 0.5rem; /* tracelink-mb-2 */
        }

        .tracelink-form-input {
            width: 100%;
            background: var(--tracelink-color-white-more-transparent);
            border: 1px solid rgba(148, 163, 184, 0.3);
            border-radius: 0.5rem; /* tracelink-rounded-lg */
            padding: 0.75rem 1rem; /* tracelink-px-4 tracelink-py-3 */
            font-size: 0.875rem; /* tracelink-text-sm */
            transition: all 0.2s ease;
            color: var(--tracelink-color-text-dark);
        }

        .tracelink-form-input:focus {
            border-color: var(--tracelink-color-primary-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            background: #fff; /* Fully opaque on focus */
            outline: none;
        }
        .tracelink-form-input::placeholder {
            color: var(--tracelink-color-subtle-text);
            opacity: 0.7;
        }
        textarea.tracelink-form-input {
            resize: vertical; /* Allow vertical resizing, not horizontal */
        }

        /* Professional scrollbar */
        .tracelink-timeline-container::-webkit-scrollbar {
            width: 8px;
        }
        .tracelink-timeline-container::-webkit-scrollbar-track {
            background: rgba(148, 163, 184, 0.1);
            border-radius: 4px;
        }
        .tracelink-timeline-container::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--tracelink-color-primary-blue), var(--tracelink-color-primary-dark-blue));
            border-radius: 4px;
        }

        /* Professional category tracelink-icons */
        .tracelink-category-icon {
            width: 2rem;
            height: 2rem;
            border-radius: 0.5rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            margin-right: 0.75rem;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .tracelink-timeline-spine { left: 1.5rem; }
            .tracelink-timeline-event { margin-left: 3rem; margin-right: 1rem; padding: 1rem; }
            .tracelink-timeline-pulse { left: 1rem; top: 1rem; width: 1.25rem; height: 1.25rem; } /* Smaller tracelink-pulse */
            .tracelink-btn {
                padding: 0.625rem 1rem; /* Adjusted for smaller screens */
                font-size: 0.875rem;
            }
            .tracelink-modal-content {
                margin: 0.5rem; /* More space around modal on small screens */
            }
            .tracelink-action-buttons {
                flex-direction: column; /* Stack tracelink-buttons vertically on small screens */
                align-items: stretch;
            }
            .tracelink-action-buttons .tracelink-btn {
                width: 100%; /* Full width for stacked tracelink-buttons */
            }
            /* Adjust font sizes for smaller screens */
            .tracelink-text-xl { font-size: 1.125rem; } /* H2 in Command Center */
            .tracelink-text-lg { font-size: 1rem; } /* Event title */
            .tracelink-prose-sm p { font-size: 0.8rem; } /* Event description */
            .tracelink-text-sm { font-size: 0.8rem; } /* General small text */
            .tracelink-text-xs { font-size: 0.7rem; } /* Smaller labels */
            .tracelink-header-gradient h1 { font-size: 1.5rem; } /* Header title */
        }
        @media (min-width: 768px) { /* Medium screens and up */
            .tracelink-md\:text-left { text-align: left; }
        }
        @media (min-width: 1024px) { /* Large screens and up */
            .tracelink-lg\:items-end { align-items: flex-end; }
            .tracelink-action-buttons {
                flex-direction: row; /* Horizontal for large screens */
                justify-content: space-between;
                gap: 1rem; /* Ensure consistent spacing */
            }
            .tracelink-action-buttons .tracelink-btn {
                width: auto; /* Allow tracelink-buttons to size naturally */
                flex-grow: 1; /* Distribute space evenly */
            }
        }


        /* Professional tracelink-animations */
        @keyframes tracelink-slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tracelink-animate-slide-up {
            animation: tracelink-slideInUp 0.4s ease-out;
        }

        /* Professional loading state */
        .tracelink-loading-shimmer {
            background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
            background-size: 200% 100%;
            animation: tracelink-shimmer 2s infinite;
        }

        @keyframes tracelink-shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* Notification styles */
        #tracelink-notificationContainer {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .tracelink-notification {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: 500;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            transform: translateX(120%); /* Start off-screen */
            opacity: 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-width: 200px;
        }

        .tracelink-notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .tracelink-notification.success { background-color: var(--tracelink-severity-low); } /* emerald-500 */
        .tracelink-notification.error { background-color: var(--tracelink-severity-critical); } /* red-500 */
        .tracelink-notification.info { background-color: var(--tracelink-color-primary-blue); } /* blue-500 */

        /* Generic prose/description styling (simple replacement for @tailwindcss/typography) */
        .tracelink-prose-sm p {
            font-size: 0.875rem; /* tracelink-text-sm */
            line-height: 1.5;
            color: #334155; /* tracelink-text-slate-700 */
        }
    </style>
</head>
<body>
    <header class="tracelink-header-gradient tracelink-text-white tracelink-sticky tracelink-top-0 tracelink-z-40">
        <div class="tracelink-container tracelink-px-6 tracelink-py-4">
            <div class="tracelink-flex tracelink-items-center tracelink-justify-between">
                <div class="tracelink-flex tracelink-items-center tracelink-space-x-4">
                    <div class="tracelink-w-10 tracelink-h-10 tracelink-bg-gradient-to-br tracelink-rounded-lg tracelink-flex tracelink-items-center tracelink-justify-center">
                        <svg class="tracelink-w-6 tracelink-h-6 tracelink-text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="tracelink-text-2xl tracelink-font-bold tracelink-tracking-tight">Tracelink-CyberTimeline Pro</h1>
                        <p class="tracelink-text-sm tracelink-text-slate-300 tracelink-font-medium">Advanced Threat Investigation Platform</p>
                    </div>
                </div>
                <div class="tracelink-flex tracelink-items-center tracelink-space-x-4">
                    <div class="tracelink-text-right">
                        <div class="tracelink-text-sm tracelink-font-medium">Security Operations Center</div>
                        <div class="tracelink-text-xs tracelink-text-slate-300">Incident Response Dashboard</div>
                    </div>
                    <div class="tracelink-w-8 tracelink-h-8 tracelink-bg-gradient-to-br tracelink-emerald-teal tracelink-rounded-full tracelink-flex tracelink-items-center tracelink-justify-center">
                        <div class="tracelink-w-2 tracelink-h-2 tracelink-bg-white tracelink-rounded-full tracelink-animate-pulse"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="tracelink-container tracelink-px-6 tracelink-py-8">
        
        <section class="tracelink-glass-card tracelink-p-6 tracelink-mb-8 tracelink-animate-slide-up">
            <div class="tracelink-flex tracelink-items-center tracelink-justify-between tracelink-mb-6">
                <div>
                    <h2 class="tracelink-text-xl tracelink-font-bold tracelink-text-slate-800 tracelink-mb-1">Investigation Command Center</h2>
                    <p class="tracelink-text-sm tracelink-text-slate-600">Orchestrate and visualize cyber threat investigations</p>
                </div>
                <div class="tracelink-flex tracelink-items-center tracelink-space-x-2">
                    <div class="tracelink-w-3 tracelink-h-3 tracelink-bg-emerald-500 tracelink-rounded-full tracelink-animate-pulse"></div>
                    <span class="tracelink-text-sm tracelink-text-slate-700 tracelink-font-medium">Live Monitoring</span>
                </div>
            </div>
            
            <div class="tracelink-flex tracelink-flex-wrap tracelink-gap-4 tracelink-mb-6 tracelink-action-buttons">
                <button id="tracelink-addEventBtn" class="tracelink-btn tracelink-btn-primary tracelink-space-x-2">
                    <svg class="tracelink-w-5 tracelink-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                    </svg>
                    <span>Add New Event</span>
                </button>
                <button id="tracelink-loadSampleBtn" class="tracelink-btn tracelink-btn-secondary tracelink-space-x-2">
                    <svg class="tracelink-w-5 tracelink-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    <span>Load Sample</span>
                </button>
                <button id="tracelink-importBtn" class="tracelink-btn tracelink-btn-warning tracelink-space-x-2">
                    <svg class="tracelink-w-5 tracelink-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                    <span>Import Data</span>
                </button>
                <input type="file" id="tracelink-importFile" accept=".json" class="tracelink-hidden" aria-label="Import investigation file">
                <button id="tracelink-exportBtn" class="tracelink-btn tracelink-btn-success tracelink-space-x-2">
                    <svg class="tracelink-w-5 tracelink-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                    </svg>
                    <span>Export Timeline</span>
                </button>
                <button id="tracelink-clearAllBtn" class="tracelink-btn tracelink-btn-danger tracelink-space-x-2">
                    <svg class="tracelink-w-4 tracelink-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 0 00-1 1v3M4 7h16"/>
                    </svg>
                    <span>Clear All</span>
                </button>
            </div>

            <div class="tracelink-border-t tracelink-border-slate-200 tracelink-pt-6">
                <h3 class="tracelink-text-lg tracelink-font-bold tracelink-text-slate-800 tracelink-mb-4">Threat Intelligence Filters</h3>
                <div class="tracelink-grid tracelink-grid-cols-1 tracelink-lg\:grid-cols-2 tracelink-gap-4">
                    <div>
                        <label for="tracelink-categoryFilter" class="tracelink-form-label">MITRE ATT&CK Category</label>
                        <select id="tracelink-categoryFilter" class="tracelink-form-input" aria-label="Filter by Threat Category">
                            <option value="">All Categories</option>
                            <option value="initial-access">🎯 Initial Access</option>
                            <option value="execution">⚡ Execution</option>
                            <option value="persistence">🔒 Persistence</option>
                            <option value="privilege-escalation">⬆️ Privilege Escalation</option>
                            <option value="defense-evasion">🛡️ Defense Evasion</option>
                            <option value="credential-access">🔑 Credential Access</option>
                            <option value="discovery">🔍 Discovery</option>
                            <option value="lateral-movement">➡️ Lateral Movement</option>
                            <option value="collection">📊 Collection</option>
                            <option value="exfiltration">📤 Exfiltration</option>
                            <option value="command-control">📡 Command & Control</option>
                            <option value="impact">💥 Impact</option>
                        </select>
                    </div>
                    <div>
                        <label for="tracelink-searchFilter" class="tracelink-form-label">Keyword Search</label>
                        <input type="text" id="tracelink-searchFilter" placeholder="Search IOCs, TTPs, event details..." 
                               class="tracelink-form-input" aria-label="Search threat intelligence keywords">
                    </div>
                </div>
            </div>
        </section>

        <section class="tracelink-glass-card tracelink-p-6 tracelink-animate-slide-up">
            <div class="tracelink-flex tracelink-items-center tracelink-justify-between tracelink-mb-6">
                <div class="tracelink-flex tracelink-items-center tracelink-space-x-4">
                    <h2 class="tracelink-text-xl tracelink-font-bold tracelink-text-slate-800">Attack Timeline Analysis</h2>
                    <div class="tracelink-flex tracelink-items-center tracelink-space-x-2">
                        <div class="tracelink-w-2 tracelink-h-2 tracelink-bg-blue-500 tracelink-rounded-full tracelink-animate-pulse"></div>
                        <span id="tracelink-eventCount" class="tracelink-text-sm tracelink-text-slate-600 tracelink-font-medium">0 events tracked</span>
                    </div>
                </div>
                <div class="tracelink-flex tracelink-items-center tracelink-space-x-3">
                    <div class="tracelink-text-right">
                        <div class="tracelink-text-sm tracelink-text-slate-700 tracelink-font-medium">Investigation Status</div>
                        <div class="tracelink-text-xs tracelink-text-emerald-600 tracelink-font-medium">● Active Monitoring</div>
                    </div>
                </div>
            </div>
            
            <div id="tracelink-timelineContainer" class="tracelink-timeline-container">
                <div class="tracelink-timeline-spine"></div>
                </div>
            
            <div id="tracelink-emptyState" class="tracelink-text-center tracelink-py-8">
                <div class="tracelink-w-24 tracelink-h-24 tracelink-mx-auto tracelink-mb-6 tracelink-rounded-2xl tracelink-bg-slate-100 tracelink-flex tracelink-items-center tracelink-justify-center">
                    <svg class="tracelink-w-12 tracelink-h-12 tracelink-text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                    </svg>
                </div>
                <h3 class="tracelink-text-lg tracelink-font-semibold tracelink-text-slate-700 tracelink-mb-2">No Investigation Data Available</h3>
                <p class="tracelink-text-slate-500 tracelink-mb-6 tracelink-max-w-md tracelink-mx-auto">Begin your cyber threat analysis by adding a new security event or load a sample investigation to explore platform capabilities.</p>
                <div class="tracelink-flex tracelink-justify-center tracelink-space-x-4">
                    <button id="tracelink-emptyStateAddEventBtn" class="tracelink-btn tracelink-btn-primary">
                        Add First Event
                    </button>
                    <button id="tracelink-emptyStateLoadSampleBtn" class="tracelink-btn tracelink-btn-secondary">
                        Load Sample Data
                    </button>
                </div>
            </div>
        </section>
    </main>

    <div id="tracelink-eventModal" class="tracelink-modal tracelink-hidden" role="dialog" aria-modal="true" aria-labelledby="tracelink-modalTitle">
        <div class="tracelink-modal-backdrop"></div>
        <div class="tracelink-modal-content">
            
            <div class="tracelink-bg-gradient-to-r tracelink-from-slate-800 tracelink-to-slate-900 tracelink-text-white tracelink-p-6 tracelink-rounded-t-2xl">
                <div class="tracelink-flex tracelink-items-center tracelink-justify-between">
                    <div class="tracelink-flex tracelink-items-center tracelink-space-x-4">
                        <div class="tracelink-w-10 tracelink-h-10 tracelink-bg-gradient-to-br tracelink-rounded-lg tracelink-flex tracelink-items-center tracelink-justify-center">
                            <svg class="tracelink-w-6 tracelink-h-6 tracelink-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="tracelink-modalTitle" class="tracelink-text-xl tracelink-font-bold">Add Security Event</h3>
                            <p class="tracelink-text-sm tracelink-text-slate-300">Document comprehensive threat intelligence and attack indicators</p>
                        </div>
                    </div>
                    <button id="tracelink-closeModal" class="tracelink-text-slate-400 hover:tracelink-text-white tracelink-transition-colors" aria-label="Close modal">
                        <svg class="tracelink-w-6 tracelink-h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="tracelink-p-8">
                <form id="tracelink-eventForm" class="tracelink-space-y-6">
                    
                    <div class="tracelink-glass-card tracelink-p-6">
                        <h4 class="tracelink-text-lg tracelink-font-bold tracelink-text-slate-800 tracelink-flex tracelink-items-center">
                            <svg class="tracelink-w-5 tracelink-h-5 tracelink-mr-2 tracelink-text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            Event Classification
                        </h4>
                        
                        <div class="tracelink-grid tracelink-grid-cols-1 tracelink-lg\:grid-cols-2 tracelink-gap-6">
                            <div>
                                <label for="tracelink-eventTimestamp" class="tracelink-form-label">Timestamp *</label>
                                <input type="datetime-local" id="tracelink-eventTimestamp" required
                                       class="tracelink-form-input" aria-required="true">
                            </div>
                            
                            <div>
                                <label for="tracelink-eventCategory" class="tracelink-form-label">MITRE ATT&CK Category *</label>
                                <select id="tracelink-eventCategory" required class="tracelink-form-input" aria-required="true">
                                    <option value="">Select Threat Category</option>
                                    <option value="initial-access">🎯 Initial Access</option>
                                    <option value="execution">⚡ Execution</option>
                                    <option value="persistence">🔒 Persistence</option>
                                    <option value="privilege-escalation">⬆️ Privilege Escalation</option>
                                    <option value="defense-evasion">🛡️ Defense Evasion</option>
                                    <option value="credential-access">🔑 Credential Access</option>
                                    <option value="discovery">🔍 Discovery</option>
                                    <option value="lateral-movement">➡️ Lateral Movement</option>
                                    <option value="collection">📊 Collection</option>
                                    <option value="exfiltration">📤 Exfiltration</option>
                                    <option value="command-control">📡 Command & Control</option>
                                    <option value="impact">💥 Impact</option>
                                </select>
                            </div>
                        </div>

                        <div class="tracelink-mt-6">
                            <label for="tracelink-eventTitle" class="tracelink-form-label">Event Title *</label>
                            <input type="text" id="tracelink-eventTitle" required placeholder="Concise summary of the security event"
                                   class="tracelink-form-input" aria-required="true">
                        </div>
                    </div>

                    <div class="tracelink-glass-card tracelink-p-6">
                        <h4 class="tracelink-text-lg tracelink-font-bold tracelink-text-slate-800 tracelink-flex tracelink-items-center">
                            <svg class="tracelink-w-5 tracelink-h-5 tracelink-mr-2 tracelink-text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            Threat Intelligence Analysis
                        </h4>
                        
                        <div class="tracelink-grid tracelink-grid-cols-1 tracelink-lg\:grid-cols-2 tracelink-gap-6">
                            <div>
                                <label for="tracelink-eventSeverity" class="tracelink-form-label">Risk Severity *</label>
                                <select id="tracelink-eventSeverity" required class="tracelink-form-input" aria-required="true">
                                    <option value="">Select Risk Level</option>
                                    <option value="critical">🔴 Critical - Immediate Response Required</option>
                                    <option value="high">🟠 High - Urgent Investigation</option>
                                    <option value="medium">🟡 Medium - Standard Response</option>
                                    <option value="low">🟢 Low - Monitor & Log</option>
                                    <option value="info">🔵 Info - Contextual Data</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="tracelink-eventAssets" class="tracelink-form-label">Affected Assets</label>
                                <input type="text" id="tracelink-eventAssets" placeholder="e.g., WS-FINANCE-01, Domain Controller, 192.168.1.x"
                                       class="tracelink-form-input">
                            </div>
                        </div>

                        <div class="tracelink-mt-6">
                            <label for="tracelink-eventIOCs" class="tracelink-form-label">Indicators of Compromise (IOCs)</label>
                            <textarea id="tracelink-eventIOCs" rows="3" placeholder="e.g., malicious-domain.com, SHA256:a1b2c3..., 10.0.0.5"
                                      class="tracelink-form-input"></textarea>
                        </div>
                    </div>

                    <div class="tracelink-glass-card tracelink-p-6">
                        <h4 class="tracelink-text-lg tracelink-font-bold tracelink-text-slate-800 tracelink-flex tracelink-items-center">
                            <svg class="tracelink-w-5 tracelink-h-5 tracelink-mr-2 tracelink-text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                            Technical Analysis
                        </h4>
                        
                        <div class="tracelink-space-y-6">
                            <div>
                                <label for="tracelink-eventDescription" class="tracelink-form-label">Detailed Description *</label>
                                <textarea id="tracelink-eventDescription" rows="4" required
                                          placeholder="Provide a comprehensive analysis of the security event, including attack vectors, techniques, and potential impact on systems and data. Detail any observed adversary behavior and system anomalies."
                                          class="tracelink-form-input" aria-required="true"></textarea>
                            </div>
                            
                            <div class="tracelink-grid tracelink-grid-cols-1 tracelink-lg\:grid-cols-2 tracelink-gap-6">
                                <div>
                                    <label for="tracelink-eventMitre" class="tracelink-form-label">MITRE ATT&CK Technique ID</label>
                                    <input type="text" id="tracelink-eventMitre" placeholder="e.g., T1055, T1059.001, T1566"
                                           class="tracelink-form-input">
                                </div>
                                
                                <div>
                                    <label for="tracelink-eventSources" class="tracelink-form-label">Evidence Sources</label>
                                    <input type="text" id="tracelink-eventSources" placeholder="e.g., EDR, SIEM, Network Logs, Forensic Image"
                                           class="tracelink-form-input">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tracelink-flex tracelink-justify-end tracelink-space-x-4 tracelink-pt-6 tracelink-border-t tracelink-border-slate-200">
                        <button type="button" id="tracelink-cancelBtn" class="tracelink-btn tracelink-btn-text-only">
                            Cancel
                        </button>
                        <button type="submit" class="tracelink-btn tracelink-btn-primary tracelink-px-8">
                            <span id="tracelink-submitText">Add Event</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="tracelink-deleteConfirmModal" class="tracelink-modal tracelink-hidden" role="dialog" aria-modal="true" aria-labelledby="tracelink-deleteModalTitle">
        <div class="tracelink-modal-backdrop"></div>
        <div class="tracelink-modal-content tracelink-max-w-md">
            <div class="tracelink-bg-gradient-to-r tracelink-from-red-600 tracelink-to-red-800 tracelink-text-white tracelink-p-6 tracelink-rounded-t-2xl tracelink-flex tracelink-items-center tracelink-justify-between">
                <div class="tracelink-flex tracelink-items-center tracelink-space-x-4">
                    <svg class="tracelink-w-6 tracelink-h-6 tracelink-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                    </svg>
                    <h3 id="tracelink-deleteModalTitle" class="tracelink-text-xl tracelink-font-bold">Confirm Deletion</h3>
                </div>
                <button id="tracelink-closeDeleteModal" class="tracelink-text-red-200 hover:tracelink-text-white tracelink-transition-colors" aria-label="Close delete confirmation">
                    <svg class="tracelink-w-6 tracelink-h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="tracelink-p-6 tracelink-text-slate-700">
                <p class="tracelink-mb-6">Are you certain you want to delete this security event? This action is irreversible and the event data will be permanently removed from the timeline.</p>
                <div class="tracelink-flex tracelink-justify-end tracelink-space-x-4">
                    <button id="tracelink-cancelDeleteBtn" class="tracelink-btn tracelink-btn-text-only">
                        Cancel
                    </button>
                    <button id="tracelink-confirmDeleteBtn" class="tracelink-btn tracelink-btn-danger">
                        Delete Permanently
                    </button>
                </div>
            </div>
        </div>
    </div>


    <div id="tracelink-notificationContainer"></div>

    <script>
        // Polyfill for crypto.randomUUID (for older browsers, though modern ones support it)
        // This is a simplified version and may not be cryptographically strong enough for all use cases,
        // but sufficient for a POC unique ID generation.
        if (typeof crypto.randomUUID === 'undefined') {
            crypto.randomUUID = function() {
                // A very basic UUID v4 implementation. Not collision-proof for large scale, but fine for a local POC.
                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                });
            };
        }

        // --- EventService Class ---
        class TracelinkEventService {
            constructor() {
                this.events = [];
            }

            addEvent(eventData) {
                eventData.id = crypto.randomUUID(); // Generate a unique ID for each event
                this.events.push(eventData);
                this._sortEvents();
            }

            updateEvent(id, updatedData) {
                const index = this.events.findIndex(event => event.id === id);
                if (index !== -1) {
                    this.events[index] = { ...this.events[index], ...updatedData };
                    this._sortEvents();
                } else {
                    console.warn(`Event with ID ${id} not found for update.`);
                }
            }

            deleteEvent(id) {
                this.events = this.events.filter(event => event.id !== id);
                this._sortEvents();
            }

            getAllEvents(categoryFilter = '', searchFilter = '') {
                let filteredEvents = [...this.events]; // Work with a copy

                if (categoryFilter) {
                    filteredEvents = filteredEvents.filter(event => event.category === categoryFilter);
                }

                if (searchFilter) {
                    const lowerCaseSearch = searchFilter.toLowerCase();
                    filteredEvents = filteredEvents.filter(event => 
                        event.title.toLowerCase().includes(lowerCaseSearch) ||
                        event.description.toLowerCase().includes(lowerCaseSearch) ||
                        (event.iocs && event.iocs.toLowerCase().includes(lowerCaseSearch)) ||
                        (event.assets && event.assets.toLowerCase().includes(lowerCaseSearch)) ||
                        (event.mitre && event.mitre.toLowerCase().includes(lowerCaseSearch)) ||
                        (event.sources && event.sources.toLowerCase().includes(lowerCaseSearch))
                    );
                }
                
                return filteredEvents;
            }

            clearAll() {
                this.events = [];
            }

            _sortEvents() {
                this.events.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
            }

            loadSampleData() {
                this.events = [
                    {
                        id: crypto.randomUUID(),
                        timestamp: new Date(Date.now() - 3600000).toISOString().slice(0, 16),
                        category: 'initial-access',
                        title: 'Spear Phishing Email Detected',
                        severity: 'high',
                        assets: 'Finance Department Workstations',
                        iocs: 'sender@malicious-domain.com, attachment.pdf (SHA256: a1b2c3...)',
                        description: 'Targeted phishing campaign identified targeting finance department with malicious PDF attachment containing macro-enabled exploit. This attack vector leveraged social engineering to bypass initial email security layers, indicating a sophisticated adversary.',
                        mitre: 'T1566.001',
                        sources: 'Email Security Gateway, SIEM'
                    },
                    {
                        id: crypto.randomUUID(),
                        timestamp: new Date(Date.now() - 3000000).toISOString().slice(0, 16),
                        category: 'execution',
                        title: 'Malicious Macro Execution',
                        severity: 'critical',
                        assets: 'WS-FINANCE-01',
                        iocs: 'powershell.exe, cmd.exe, suspicious script execution',
                        description: 'User opened malicious PDF, triggering macro execution that downloaded and executed PowerShell payload. The payload attempted to establish a persistent backdoor, showcasing the rapid progression of the attack chain.',
                        mitre: 'T1059.001',
                        sources: 'EDR, Process Monitor'
                    },
                    {
                        id: crypto.randomUUID(),
                        timestamp: new Date(Date.now() - 2400000).toISOString().slice(0, 16),
                        category: 'persistence',
                        title: 'Registry Persistence Established',
                        severity: 'high',
                        assets: 'WS-FINANCE-01',
                        iocs: 'HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run',
                        description: 'Malware established persistence through registry modification to ensure execution on system reboot. This technique ensures the adversary maintains access even after the compromised system is restarted, complicating remediation efforts.',
                        mitre: 'T1547.001',
                        sources: 'Registry Monitor, SIEM'
                    },
                    {
                        id: crypto.randomUUID(),
                        timestamp: new Date(Date.now() - 1800000).toISOString().slice(0, 16),
                        category: 'credential-access',
                        title: 'Credential Dumping Attempted',
                        severity: 'critical',
                        assets: 'WS-FINANCE-01, Domain Controller',
                        iocs: 'lsass.exe memory access, mimikatz indicators',
                        description: 'Unauthorized attempt to extract credentials from system memory using advanced credential dumping techniques. This indicates a clear intent to move laterally and escalate privileges within the network.',
                        mitre: 'T1003.001',
                        sources: 'EDR, Security Event Logs'
                    },
                    {
                        id: crypto.randomUUID(),
                        timestamp: new Date(Date.now() - 1200000).toISOString().slice(0, 16),
                        category: 'lateral-movement',
                        title: 'Unauthorized SMB Connection',
                        severity: 'high',
                        assets: 'Multiple Windows Servers',
                        iocs: '192.168.1.100, abnormal SMB traffic patterns',
                        description: 'Lateral movement detected using compromised credentials to access additional systems via SMB protocol. The threat actor is actively exploring the network to identify high-value targets.',
                        mitre: 'T1021.002',
                        sources: 'Network Monitor, SIEM'
                    },
                    {
                        id: crypto.randomUUID(),
                        timestamp: new Date(Date.now() - 600000).toISOString().slice(0, 16),
                        category: 'exfiltration',
                        title: 'Data Exfiltration Detected',
                        severity: 'critical',
                        assets: 'File Server, Network Gateway',
                        iocs: 'Large outbound data transfers, encrypted communications',
                        description: 'Unauthorized exfiltration of sensitive financial data detected through network monitoring and DLP systems. This is the final stage of the attack, representing a significant data breach.',
                        mitre: 'T1041',
                        sources: 'DLP, Network Analysis, SIEM'
                    }
                ];
                this._sortEvents();
            }

            exportData() {
                const data = {
                    events: this.events,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `tracelink-cybertimeline-${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            importData(file) {
                return new Promise((resolve, reject) => {
                    if (!file) {
                        return reject(new Error('No file selected.'));
                    }

                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            if (data.events && Array.isArray(data.events)) {
                                this.events = data.events;
                                this._sortEvents();
                                resolve();
                            } else {
                                reject(new Error('Invalid file format: Missing "events" array.'));
                            }
                        } catch (error) {
                            reject(new Error(`Failed to parse JSON: ${error.message}`));
                        }
                    };
                    reader.onerror = () => {
                        reject(new Error('Failed to read file.'));
                    };
                    reader.readAsText(file);
                });
            }
        }

        // --- ModalHandler Class ---
        class TracelinkModalHandler {
            constructor(modalId, formId, onSubmitCallback) {
                this.modal = document.getElementById(modalId);
                this.form = document.getElementById(formId);
                this.modalTitle = document.getElementById('tracelink-modalTitle');
                this.submitButtonText = document.getElementById('tracelink-submitText');
                this.onSubmitCallback = onSubmitCallback; // Callback to handle form submission
                this.editingEventId = null; // Store the ID of the event being edited

                this._bindEvents();
            }

            _bindEvents() {
                document.getElementById('tracelink-closeModal').addEventListener('click', () => this.close());
                document.getElementById('tracelink-cancelBtn').addEventListener('click', () => this.close());
                this.form.addEventListener('submit', (e) => this._handleSubmit(e));
                
                // Close modal on backdrop click
                this.modal.addEventListener('click', (e) => {
                    if (e.target.id === this.modal.id || e.target.classList.contains('tracelink-modal-backdrop')) {
                        this.close();
                    }
                });
            }

            open(eventData = null) {
                this.form.reset(); // Clear form fields first
                this.editingEventId = null; // Reset editing ID

                if (eventData) {
                    this.modalTitle.textContent = 'Edit Security Event';
                    this.submitButtonText.textContent = 'Update Event';
                    this._populateForm(eventData);
                    this.editingEventId = eventData.id; // Store the ID for updating
                } else {
                    this.modalTitle.textContent = 'Add Security Event';
                    this.submitButtonText.textContent = 'Add Event';
                    this._setDefaultTimestamp();
                }
                
                this.modal.classList.remove('tracelink-hidden');
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            }

            close() {
                this.modal.classList.add('tracelink-hidden');
                document.body.style.overflow = 'auto'; // Re-enable background scrolling
                this.editingEventId = null; // Clear editing state
            }

            _populateForm(event) {
                document.getElementById('tracelink-eventTimestamp').value = event.timestamp;
                document.getElementById('tracelink-eventCategory').value = event.category;
                document.getElementById('tracelink-eventTitle').value = event.title;
                document.getElementById('tracelink-eventSeverity').value = event.severity;
                document.getElementById('tracelink-eventAssets').value = event.assets || '';
                document.getElementById('tracelink-eventIOCs').value = event.iocs || '';
                document.getElementById('tracelink-eventDescription').value = event.description;
                document.getElementById('tracelink-eventMitre').value = event.mitre || '';
                document.getElementById('tracelink-eventSources').value = event.sources || '';
            }

            _setDefaultTimestamp() {
                const now = new Date();
                now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
                document.getElementById('tracelink-eventTimestamp').value = now.toISOString().slice(0, 16);
            }

            _handleSubmit(e) {
                e.preventDefault();
                
                const eventData = {
                    timestamp: document.getElementById('tracelink-eventTimestamp').value,
                    category: document.getElementById('tracelink-eventCategory').value,
                    title: document.getElementById('tracelink-eventTitle').value,
                    severity: document.getElementById('tracelink-eventSeverity').value,
                    assets: document.getElementById('tracelink-eventAssets').value,
                    iocs: document.getElementById('tracelink-eventIOCs').value,
                    description: document.getElementById('tracelink-eventDescription').value,
                    mitre: document.getElementById('tracelink-eventMitre').value,
                    sources: document.getElementById('tracelink-eventSources').value,
                };

                // Call the callback with the event data and editing status
                this.onSubmitCallback(eventData, this.editingEventId !== null);
                this.close();
            }
        }

        // --- DeleteConfirmationModalHandler Class ---
        class TracelinkDeleteConfirmationModalHandler {
            constructor(modalId, confirmBtnId, cancelBtnId, closeBtnId, onDeleteConfirmCallback) {
                this.modal = document.getElementById(modalId);
                this.confirmButton = document.getElementById(confirmBtnId);
                this.cancelButton = document.getElementById(cancelBtnId);
                this.closeButton = document.getElementById(closeBtnId);
                this.onDeleteConfirmCallback = onDeleteConfirmCallback;
                this.eventIdToDelete = null;

                this._bindEvents();
            }

            _bindEvents() {
                this.confirmButton.addEventListener('click', () => this._handleConfirm());
                this.cancelButton.addEventListener('click', () => this.close());
                this.closeButton.addEventListener('click', () => this.close());
                this.modal.addEventListener('click', (e) => {
                    if (e.target.id === this.modal.id || e.target.classList.contains('tracelink-modal-backdrop')) {
                        this.close();
                    }
                });
            }

            open(eventId) {
                this.eventIdToDelete = eventId;
                this.modal.classList.remove('tracelink-hidden');
                document.body.style.overflow = 'hidden';
            }

            close() {
                this.modal.classList.add('tracelink-hidden');
                document.body.style.overflow = 'auto';
                this.eventIdToDelete = null;
            }

            _handleConfirm() {
                if (this.eventIdToDelete) {
                    this.onDeleteConfirmCallback(this.eventIdToDelete);
                }
                this.close();
            }
        }


        // --- TimelineRenderer Class ---
        class TracelinkTimelineRenderer {
            constructor(eventService) {
                this.eventService = eventService; // Dependency injection for data access
                this.timelineContainer = document.getElementById('tracelink-timelineContainer');
                this.emptyState = document.getElementById('tracelink-emptyState');
                this.eventCountDisplay = document.getElementById('tracelink-eventCount');
            }

            render(categoryFilter = '', searchFilter = '') {
                const eventsToRender = this.eventService.getAllEvents(categoryFilter, searchFilter);
                
                // Update empty state visibility
                if (eventsToRender.length === 0) {
                    this.emptyState.style.display = 'block';
                    this.timelineContainer.style.display = 'none';
                    this.eventCountDisplay.textContent = '0 events tracked';
                    return;
                }

                this.emptyState.style.display = 'none';
                this.timelineContainer.style.display = 'block';
                this.eventCountDisplay.textContent = `${eventsToRender.length} event${eventsToRender.length !== 1 ? 's' : ''} tracked`;

                // Clear existing events (keep spine)
                const existingEventElements = this.timelineContainer.querySelectorAll('.tracelink-timeline-event');
                existingEventElements.forEach(el => el.remove());

                // Add events
                eventsToRender.forEach((event, index) => {
                    const eventElement = this._createEventElement(event, index);
                    this.timelineContainer.appendChild(eventElement);
                });
            }

            _createEventElement(event, index) {
                const eventDiv = document.createElement('div');
                eventDiv.className = `tracelink-timeline-event tracelink-threat-${event.severity} tracelink-animate-slide-up`;
                eventDiv.style.animationDelay = `${index * 0.05}s`; // Staggered animation, slightly faster for professionalism

                const categoryIcon = this._getCategoryIcon(event.category);
                const severityBadge = this._getSeverityBadge(event.severity);
                const formattedDate = new Date(event.timestamp).toLocaleString();

                eventDiv.innerHTML = `
                    <div class="tracelink-timeline-pulse tracelink-border-${this._getSeverityColor(event.severity)}-500"></div>
                    
                    <div class="tracelink-flex tracelink-items-start tracelink-justify-between tracelink-mb-4">
                        <div class="tracelink-flex tracelink-items-center tracelink-space-x-3">
                            <div class="tracelink-category-icon tracelink-bg-${this._getSeverityColor(event.severity)}-100 tracelink-text-${this._getSeverityColor(event.severity)}-600">
                                ${categoryIcon}
                            </div>
                            <div>
                                <h3 class="tracelink-font-bold tracelink-text-slate-800 tracelink-text-lg">${this._sanitizeHTML(event.title)}</h3>
                                <p class="tracelink-text-sm tracelink-text-slate-600">${formattedDate}</p>
                            </div>
                        </div>
                        <div class="tracelink-flex tracelink-items-center tracelink-space-x-2">
                            ${severityBadge}
                            <div class="tracelink-flex tracelink-space-x-1">
                                <button class="tracelink-p-2 tracelink-text-slate-400 hover:tracelink-text-blue-600 tracelink-transition-colors tracelink-edit-event-btn" 
                                        data-event-id="${event.id}" aria-label="Edit event">
                                    <svg class="tracelink-w-4 tracelink-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                    </svg>
                                </button>
                                <button class="tracelink-p-2 tracelink-text-slate-400 hover:tracelink-text-red-600 tracelink-transition-colors tracelink-delete-event-btn" 
                                        data-event-id="${event.id}" aria-label="Delete event">
                                    <svg class="tracelink-w-4 tracelink-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 0 00-1 1v3M4 7h16"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="tracelink-prose-sm">
                        <p class="tracelink-text-slate-700">${this._sanitizeHTML(event.description)}</p>
                    </div>

                    ${event.assets ? `
                        <div class="tracelink-mb-3">
                            <span class="tracelink-text-xs tracelink-font-semibold tracelink-text-slate-600 tracelink-uppercase tracelink-tracking-wide">Affected Assets:</span>
                            <p class="tracelink-text-sm tracelink-text-slate-700 tracelink-mt-1">${this._sanitizeHTML(event.assets)}</p>
                        </div>
                    ` : ''}

                    ${event.iocs ? `
                        <div class="tracelink-mb-3">
                            <span class="tracelink-text-xs tracelink-font-semibold tracelink-text-slate-600 tracelink-uppercase tracelink-tracking-wide">Indicators of Compromise (IOCs):</span>
                            <p class="tracelink-text-sm tracelink-text-slate-700 tracelink-mt-1 tracelink-font-mono tracelink-bg-slate-50 tracelink-p-2 tracelink-rounded">${this._sanitizeHTML(event.iocs)}</p>
                        </div>
                    ` : ''}

                    <div class="tracelink-flex tracelink-flex-wrap tracelink-gap-2 tracelink-text-xs">
                        ${event.mitre ? `<span class="tracelink-bg-purple-100 tracelink-text-purple-800 tracelink-px-2 tracelink-py-1 tracelink-rounded-full tracelink-font-medium">MITRE ATT&CK: ${this._sanitizeHTML(event.mitre)}</span>` : ''}
                        ${event.sources ? `<span class="tracelink-bg-blue-100 tracelink-text-blue-800 tracelink-px-2 tracelink-py-1 tracelink-rounded-full tracelink-font-medium">Evidence Source: ${this._sanitizeHTML(event.sources)}</span>` : ''}
                        <span class="tracelink-bg-slate-100 tracelink-text-slate-700 tracelink-px-2 tracelink-py-1 tracelink-rounded-full tracelink-font-medium">Category: ${this._getCategoryName(event.category)}</span>
                    </div>
                `;

                // Attach event listeners for edit and delete buttons
                eventDiv.querySelector('.tracelink-edit-event-btn').addEventListener('click', () => {
                    // Use the globally available tracelinkModalHandler
                    window.tracelinkModalHandler.open(event); 
                });

                eventDiv.querySelector('.tracelink-delete-event-btn').addEventListener('click', () => {
                    // Open custom delete confirmation tracelinkModal instead of native confirm()
                    window.tracelinkDeleteConfirmModalHandler.open(event.id);
                });

                return eventDiv;
            }

            _getCategoryIcon(category) {
                const icons = {
                    'initial-access': '🎯',
                    'execution': '⚡',
                    'persistence': '🔒',
                    'privilege-escalation': '⬆️',
                    'defense-evasion': '🛡️',
                    'credential-access': '🔑',
                    'discovery': '🔍',
                    'lateral-movement': '➡️',
                    'collection': '📊',
                    'exfiltration': '📤',
                    'command-control': '📡',
                    'impact': '💥'
                };
                return icons[category] || '🔍';
            }

            _getCategoryName(category) {
                const names = {
                    'initial-access': 'Initial Access',
                    'execution': 'Execution',
                    'persistence': 'Persistence',
                    'privilege-escalation': 'Privilege Escalation',
                    'defense-evasion': 'Defense Evasion',
                    'credential-access': 'Credential Access',
                    'discovery': 'Discovery',
                    'lateral-movement': 'Lateral Movement',
                    'collection': 'Collection',
                    'exfiltration': 'Exfiltration',
                    'command-control': 'Command & Control',
                    'impact': 'Impact'
                };
                return names[category] || 'Unknown';
            }

            _getSeverityBadge(severity) {
                // Map severity to new custom badge classes
                const badgeClassMap = {
                    'critical': 'tracelink-severity-critical-badge',
                    'high': 'tracelink-severity-high-badge',
                    'medium': 'tracelink-severity-medium-badge',
                    'low': 'tracelink-severity-low-badge',
                    'info': 'tracelink-severity-info-badge'
                };
                const badgeClass = badgeClassMap[severity] || '';
                return `<span class="tracelink-severity-badge ${badgeClass}">${severity.toUpperCase()}</span>`;
            }

            _getSeverityColor(severity) {
                const colors = {
                    'critical': 'red',
                    'high': 'orange',
                    'medium': 'yellow',
                    'low': 'green',
                    'info': 'blue'
                };
                return colors[severity] || 'gray';
            }

            // Basic HTML sanitization to prevent XSS (for displaying user input)
            _sanitizeHTML(str) {
                const div = document.createElement('div');
                div.appendChild(document.createTextNode(str));
                return div.innerHTML;
            }
        }

        // --- Main Application Logic (DOMContentLoaded) ---
        document.addEventListener('DOMContentLoaded', () => {
            const tracelinkEventService = new TracelinkEventService();
            const tracelinkTimelineRenderer = new TracelinkTimelineRenderer(tracelinkEventService); 

            // Make showNotification globally available for TimelineRenderer actions
            window.tracelinkShowNotification = function(message, type = 'info') {
                const notificationContainer = document.getElementById('tracelink-notificationContainer');
                const notification = document.createElement('div');
                notification.className = `tracelink-notification ${type}`;
                notification.textContent = message;

                notificationContainer.appendChild(notification);

                // Animate in
                setTimeout(() => {
                    notification.classList.add('show');
                }, 50);

                // Animate out and remove
                setTimeout(() => {
                    notification.classList.remove('show');
                    notification.addEventListener('transitionend', () => {
                        notification.remove();
                    }, { once: true });
                }, 3000);
            };

            const tracelinkModalHandler = new TracelinkModalHandler(
                'tracelink-eventModal', 
                'tracelink-eventForm', 
                (eventData, isEditing) => {
                    if (isEditing) {
                        tracelinkEventService.updateEvent(tracelinkModalHandler.editingEventId, eventData);
                        window.tracelinkShowNotification('Event updated successfully', 'success');
                    } else {
                        tracelinkEventService.addEvent(eventData);
                        window.tracelinkShowNotification('Event added successfully', 'success');
                    }
                    tracelinkTimelineRenderer.render(); 
                }
            );
            // Make tracelinkModalHandler globally accessible for TimelineRenderer to open it
            window.tracelinkModalHandler = tracelinkModalHandler;

            const tracelinkDeleteConfirmModalHandler = new TracelinkDeleteConfirmationModalHandler(
                'tracelink-deleteConfirmModal',
                'tracelink-confirmDeleteBtn',
                'tracelink-cancelDeleteBtn',
                'tracelink-closeDeleteModal',
                (eventId) => {
                    tracelinkEventService.deleteEvent(eventId);
                    tracelinkTimelineRenderer.render();
                    window.tracelinkShowNotification('Event deleted successfully', 'success');
                }
            );
            // Make tracelinkDeleteConfirmModalHandler globally accessible
            window.tracelinkDeleteConfirmModalHandler = tracelinkDeleteConfirmModalHandler;


            // --- Wire up UI tracelink-events ---

            // Command Center Buttons
            document.getElementById('tracelink-addEventBtn').addEventListener('click', () => tracelinkModalHandler.open());
            document.getElementById('tracelink-emptyStateAddEventBtn').addEventListener('click', () => tracelinkModalHandler.open()); 

            document.getElementById('tracelink-loadSampleBtn').addEventListener('click', () => {
                tracelinkEventService.loadSampleData();
                tracelinkTimelineRenderer.render();
                window.tracelinkShowNotification('Sample investigation data loaded successfully', 'success');
            });
            document.getElementById('tracelink-emptyStateLoadSampleBtn').addEventListener('click', () => { 
                tracelinkEventService.loadSampleData();
                tracelinkTimelineRenderer.render();
                window.tracelinkShowNotification('Sample investigation data loaded successfully', 'success');
            });

            document.getElementById('tracelink-exportBtn').addEventListener('click', () => {
                tracelinkEventService.exportData();
                window.tracelinkShowNotification('Timeline exported successfully', 'success');
            });

            document.getElementById('tracelink-importBtn').addEventListener('click', () => document.getElementById('tracelink-importFile').click());
            document.getElementById('tracelink-importFile').addEventListener('change', (e) => {
                tracelinkEventService.importData(e.target.files[0])
                    .then(() => {
                        tracelinkTimelineRenderer.render();
                        window.tracelinkShowNotification('Timeline imported successfully', 'success');
                    })
                    .catch(error => {
                        window.tracelinkShowNotification(`Error importing file: ${error.message}`, 'error');
                    });
            });

            document.getElementById('tracelink-clearAllBtn').addEventListener('click', () => {
                // Re-using the delete confirmation tracelinkModal for 'Clear All' but with custom text
                if (confirm('Are you sure you want to clear ALL events? This action cannot be undone.')) {
                    tracelinkEventService.clearAll();
                    tracelinkTimelineRenderer.render();
                    window.tracelinkShowNotification('All events cleared', 'success');
                }
            });

            // Filters
            document.getElementById('tracelink-categoryFilter').addEventListener('change', () => {
                const category = document.getElementById('tracelink-categoryFilter').value;
                const search = document.getElementById('tracelink-searchFilter').value;
                tracelinkTimelineRenderer.render(category, search); 
            });
            document.getElementById('tracelink-searchFilter').addEventListener('input', () => {
                const category = document.getElementById('tracelink-categoryFilter').value;
                const search = document.getElementById('tracelink-searchFilter').value;
                tracelinkTimelineRenderer.render(category, search); 
            });

            // Initial render of the timeline
            tracelinkTimelineRenderer.render();
        });
    </script>
</body>
</html>